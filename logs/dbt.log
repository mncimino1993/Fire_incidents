

============================== 2022-01-04 13:43:11.392882 | 2ec55b7a-c244-4e02-b297-c32834e734f9 ==============================
13:43:11.392882 [info ] [MainThread]: Running with dbt=1.0.1
13:43:11.408815 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/mauro/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
13:43:11.409135 [debug] [MainThread]: Tracking: tracking
13:43:11.559617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2c50040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2c500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2c50400>]}
13:43:11.598471 [info ] [MainThread]: target not specified in profile 'Fire_incidents', using 'default'
13:43:11.735995 [debug] [MainThread]: Executing "git --help"
13:43:11.745725 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:43:11.746138 [debug] [MainThread]: STDERR: "b''"
13:43:11.749684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2c752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2bb5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2bb5fd0>]}


============================== 2022-01-04 13:45:20.263454 | 52a0cf31-edd5-4970-ba0b-3c2863a36bbc ==============================
13:45:20.263454 [info ] [MainThread]: Running with dbt=1.0.1
13:45:20.275512 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/mauro/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
13:45:20.279993 [debug] [MainThread]: Tracking: tracking
13:45:20.325973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804df83130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804df835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804df83610>]}
13:45:20.365265 [info ] [MainThread]: target not specified in profile 'postgress', using 'default'
13:45:20.461994 [debug] [MainThread]: Executing "git --help"
13:45:20.479515 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:45:20.479910 [debug] [MainThread]: STDERR: "b''"
13:45:20.496944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804dfa82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804df62f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804df62af0>]}


============================== 2022-01-04 13:46:08.460013 | 26c4c0ca-a52a-4265-9767-44d53f48a9a8 ==============================
13:46:08.460013 [info ] [MainThread]: Running with dbt=1.0.1
13:46:08.462160 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/mauro/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
13:46:08.462474 [debug] [MainThread]: Tracking: tracking
13:46:08.492090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13b4650a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13b4654f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13b4655e0>]}
13:46:08.841343 [debug] [MainThread]: Executing "git --help"
13:46:08.869992 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:46:08.870404 [debug] [MainThread]: STDERR: "b''"
13:46:08.898762 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:46:08.899684 [debug] [MainThread]: Using postgres connection "debug"
13:46:08.900361 [debug] [MainThread]: On debug: select 1 as id
13:46:08.901473 [debug] [MainThread]: Opening a new connection, currently in state init
13:46:09.200362 [debug] [MainThread]: SQL status: SELECT 1 in 0.3 seconds
13:46:09.201448 [debug] [MainThread]: On debug: Close
13:46:09.215931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139bc4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139bc4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139bc49a0>]}
13:46:09.972764 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-01-04 13:57:07.633380 | e13ab303-8e8c-4d8a-a52d-ff96c78877c7 ==============================
13:57:07.633380 [info ] [MainThread]: Running with dbt=1.0.0
13:57:07.636510 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, resource_types=[], output='selector', output_keys=None, models=None, select=None, indirect_selection='eager', exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.list.ListTask'>, which='list', rpc_method=None)
13:57:07.636862 [debug] [MainThread]: Tracking: tracking
13:57:07.647637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf11f1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf11f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf11f1700>]}
13:57:07.677488 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:57:07.677797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e13ab303-8e8c-4d8a-a52d-ff96c78877c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf11e3e50>]}
13:57:07.745276 [debug] [MainThread]: Parsing macros/relations.sql
13:57:07.768987 [debug] [MainThread]: Parsing macros/adapters.sql
13:57:07.788737 [debug] [MainThread]: Parsing macros/catalog.sql
13:57:07.790707 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
13:57:07.792158 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:57:07.797618 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:57:07.805077 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:57:07.811239 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:57:07.819738 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:57:07.822103 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:57:07.831119 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:57:07.833652 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:57:07.841582 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:57:07.843505 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:57:07.845373 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:57:07.847659 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:57:07.849494 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:57:07.852829 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:57:07.854814 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:57:07.856185 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:57:07.898013 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:57:07.915087 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:57:07.924341 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:57:07.929551 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:57:07.942933 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:57:07.949963 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:57:07.958767 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:57:07.969335 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:57:07.982727 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:57:07.984119 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:57:07.986547 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:57:07.993728 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:57:07.996178 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:57:07.998371 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:57:08.005453 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:57:08.006704 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:57:08.011467 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:57:08.013083 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:57:08.014599 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:57:08.015221 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:57:08.015983 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:57:08.016466 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:57:08.017633 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:57:08.207330 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
13:57:08.218138 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
13:57:08.263981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e13ab303-8e8c-4d8a-a52d-ff96c78877c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0f605e0>]}
13:57:08.269230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e13ab303-8e8c-4d8a-a52d-ff96c78877c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0f60160>]}
13:57:08.269505 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:57:08.273422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0f60070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0f60100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0f608e0>]}


============================== 2022-01-04 14:09:20.451325 | 85c0612a-6c9d-4aed-b79a-4dc94bb32308 ==============================
14:09:20.451325 [info ] [MainThread]: Running with dbt=1.0.0
14:09:20.462399 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:09:20.462663 [debug] [MainThread]: Tracking: tracking
14:09:20.685097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c21416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2141790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2141730>]}
14:09:20.815175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:09:20.815427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:09:20.876323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85c0612a-6c9d-4aed-b79a-4dc94bb32308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c39d3dc0>]}
14:09:20.883350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85c0612a-6c9d-4aed-b79a-4dc94bb32308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c21288b0>]}
14:09:20.883699 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:09:20.885563 [info ] [MainThread]: 
14:09:20.886685 [debug] [MainThread]: Acquiring new postgres connection "master"
14:09:20.887415 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
14:09:20.898438 [debug] [ThreadPool]: Using postgres connection "list_master"
14:09:20.898715 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
14:09:20.898861 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:09:21.024273 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.13 seconds
14:09:21.025418 [debug] [ThreadPool]: On list_master: Close
14:09:21.031293 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
14:09:21.044043 [debug] [ThreadPool]: Using postgres connection "list_master_public"
14:09:21.044245 [debug] [ThreadPool]: On list_master_public: BEGIN
14:09:21.044336 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:09:21.060716 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
14:09:21.060922 [debug] [ThreadPool]: Using postgres connection "list_master_public"
14:09:21.061017 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:09:21.098257 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.04 seconds
14:09:21.099372 [debug] [ThreadPool]: On list_master_public: ROLLBACK
14:09:21.100467 [debug] [ThreadPool]: On list_master_public: Close
14:09:21.112634 [debug] [MainThread]: Using postgres connection "master"
14:09:21.112831 [debug] [MainThread]: On master: BEGIN
14:09:21.112925 [debug] [MainThread]: Opening a new connection, currently in state init
14:09:21.119708 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:09:21.121090 [debug] [MainThread]: Using postgres connection "master"
14:09:21.121226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:09:21.193382 [debug] [MainThread]: SQL status: SELECT 0 in 0.07 seconds
14:09:21.194499 [debug] [MainThread]: On master: ROLLBACK
14:09:21.194999 [debug] [MainThread]: Using postgres connection "master"
14:09:21.197951 [debug] [MainThread]: On master: BEGIN
14:09:21.199392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:09:21.199608 [debug] [MainThread]: On master: COMMIT
14:09:21.199709 [debug] [MainThread]: Using postgres connection "master"
14:09:21.199793 [debug] [MainThread]: On master: COMMIT
14:09:21.200447 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:09:21.200635 [debug] [MainThread]: On master: Close
14:09:21.208644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:09:21.209531 [info ] [MainThread]: 
14:09:21.247369 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
14:09:21.247691 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
14:09:21.248248 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
14:09:21.248374 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
14:09:21.248486 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
14:09:21.253192 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
14:09:21.253648 [debug] [Thread-1  ]: finished collecting timing info
14:09:21.253805 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
14:09:21.313165 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
14:09:21.317925 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
14:09:21.318118 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
14:09:21.318222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:21.341872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:09:21.342078 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
14:09:21.342173 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:09:21.667184 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.32 seconds
14:09:21.671931 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
14:09:21.672133 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:09:21.680699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:09:21.695536 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
14:09:21.695740 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
14:09:21.695835 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
14:09:21.732224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
14:09:21.736069 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
14:09:21.736239 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
14:09:21.737215 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
14:09:21.742655 [debug] [Thread-1  ]: finished collecting timing info
14:09:21.742862 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
14:09:21.747377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c0612a-6c9d-4aed-b79a-4dc94bb32308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2063130>]}
14:09:21.747729 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.50s]
14:09:21.752159 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
14:09:21.752687 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
14:09:21.752902 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
14:09:21.757344 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
14:09:21.757538 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
14:09:21.757644 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
14:09:21.761916 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
14:09:21.762194 [debug] [Thread-1  ]: finished collecting timing info
14:09:21.762303 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
14:09:21.797753 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
14:09:21.798135 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
14:09:21.798245 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
14:09:21.798335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:21.814232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:09:21.814434 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
14:09:21.814529 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
14:09:21.902887 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.09 seconds
14:09:21.905271 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
14:09:21.905409 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:09:21.911601 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:09:21.912743 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
14:09:21.912867 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
14:09:21.912951 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
14:09:21.916198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:09:21.917546 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
14:09:21.917690 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
14:09:21.918064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:09:21.918962 [debug] [Thread-1  ]: finished collecting timing info
14:09:21.919092 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
14:09:21.923808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c0612a-6c9d-4aed-b79a-4dc94bb32308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c0fc5f70>]}
14:09:21.924176 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.17s]
14:09:21.927301 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
14:09:21.928372 [debug] [MainThread]: Acquiring new postgres connection "master"
14:09:21.928545 [debug] [MainThread]: Using postgres connection "master"
14:09:21.928635 [debug] [MainThread]: On master: BEGIN
14:09:21.928716 [debug] [MainThread]: Opening a new connection, currently in state closed
14:09:21.940728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:09:21.940984 [debug] [MainThread]: On master: COMMIT
14:09:21.941090 [debug] [MainThread]: Using postgres connection "master"
14:09:21.941178 [debug] [MainThread]: On master: COMMIT
14:09:21.942707 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:09:21.942842 [debug] [MainThread]: On master: Close
14:09:21.945248 [info ] [MainThread]: 
14:09:21.945715 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.06s.
14:09:21.946057 [debug] [MainThread]: Connection 'master' was properly closed.
14:09:21.946183 [debug] [MainThread]: Connection 'list_master' was properly closed.
14:09:21.946289 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
14:09:21.960715 [info ] [MainThread]: 
14:09:21.961548 [info ] [MainThread]: [32mCompleted successfully[0m
14:09:21.962964 [info ] [MainThread]: 
14:09:21.963259 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:09:21.963598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2128640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c1003c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c0fc5fa0>]}


============================== 2022-01-04 14:26:32.769864 | c9e06f26-65b0-40ea-ac80-b4647b22301c ==============================
14:26:32.769864 [info ] [MainThread]: Running with dbt=1.0.0
14:26:32.789529 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, resource_types=[], output='selector', output_keys=None, models=None, select=None, indirect_selection='eager', exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.list.ListTask'>, which='list', rpc_method=None)
14:26:32.790054 [debug] [MainThread]: Tracking: tracking
14:26:32.927184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1dff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1dfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1dfe20>]}
14:26:33.076662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:26:33.076971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:26:33.136333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9e06f26-65b0-40ea-ac80-b4647b22301c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e2161f0>]}
14:26:33.144503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9e06f26-65b0-40ea-ac80-b4647b22301c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1bf940>]}
14:26:33.144895 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:26:33.149216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1bf1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1bf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e1bf520>]}


============================== 2022-01-04 14:26:57.657117 | d33fa838-d629-46c0-bc1e-252150e8b770 ==============================
14:26:57.657117 [info ] [MainThread]: Running with dbt=1.0.0
14:26:57.677255 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, resource_types=[], output='selector', output_keys=None, models=None, select=None, indirect_selection='eager', exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.list.ListTask'>, which='list', rpc_method=None)
14:26:57.677520 [debug] [MainThread]: Tracking: tracking
14:26:57.701587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458f71250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458f714f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458f713a0>]}
14:26:57.752545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:26:57.753785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:26:57.811872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd33fa838-d629-46c0-bc1e-252150e8b770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245a7a40a0>]}
14:26:57.818605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd33fa838-d629-46c0-bc1e-252150e8b770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458ef38e0>]}
14:26:57.818929 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:26:57.823138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458ef31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458ef3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2458ef3520>]}


============================== 2022-01-04 17:35:37.194792 | b7cd58cd-1dec-4d0d-a348-50ddf4ecd172 ==============================
17:35:37.194792 [info ] [MainThread]: Running with dbt=1.0.0
17:35:37.207551 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:35:37.211489 [debug] [MainThread]: Tracking: tracking
17:35:37.380874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a22bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a22beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a22bf40>]}
17:35:37.497119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:35:37.497366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:35:37.550910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7cd58cd-1dec-4d0d-a348-50ddf4ecd172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a275ee0>]}
17:35:37.558305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7cd58cd-1dec-4d0d-a348-50ddf4ecd172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a1e7820>]}
17:35:37.558665 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:35:37.563218 [info ] [MainThread]: 
17:35:37.565313 [debug] [MainThread]: Acquiring new postgres connection "master"
17:35:37.566095 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:35:37.577206 [debug] [ThreadPool]: Using postgres connection "list_master"
17:35:37.577458 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:35:37.577627 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:35:37.578023 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "127.0.0.1", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
'
17:35:37.578178 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:35:37.578291 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
17:35:37.578438 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
17:35:37.578566 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
17:35:37.578721 [debug] [ThreadPool]: On list_master: No close available on handle
17:35:37.579175 [debug] [MainThread]: Connection 'master' was properly closed.
17:35:37.579305 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:35:37.583572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a1d3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a1d3b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178a1d3460>]}


============================== 2022-01-04 17:40:15.382529 | 663b831f-73a5-44e9-b320-3f19e694da56 ==============================
17:40:15.382529 [info ] [MainThread]: Running with dbt=1.0.0
17:40:15.388325 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:40:15.388585 [debug] [MainThread]: Tracking: tracking
17:40:15.585720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c36cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c36ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c36cee0>]}
17:40:15.642349 [info ] [MainThread]: Unable to do partial parsing because profile has changed
17:40:15.645907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '663b831f-73a5-44e9-b320-3f19e694da56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c369430>]}
17:40:15.723973 [debug] [MainThread]: Parsing macros/relations.sql
17:40:15.808532 [debug] [MainThread]: Parsing macros/adapters.sql
17:40:15.833737 [debug] [MainThread]: Parsing macros/catalog.sql
17:40:15.835803 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:40:15.838932 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:40:15.842892 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:40:15.852648 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:40:15.856561 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:40:15.866718 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:40:15.870600 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:40:15.881099 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:40:15.883764 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:40:15.891978 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:40:15.894253 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:40:15.895795 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:40:15.897909 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:40:15.899177 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:40:15.904312 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:40:15.906534 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:40:15.908028 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:40:15.919931 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:40:15.938590 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:40:15.949968 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:40:15.958526 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:40:15.973438 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:40:15.979212 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:40:15.991842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:40:16.001499 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:40:16.015373 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:40:16.016908 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:40:16.022757 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:40:16.028840 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:40:16.032182 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:40:16.034312 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:40:16.045116 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:40:16.046603 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:40:16.050439 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:40:16.052730 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:40:16.054250 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:40:16.054877 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:40:16.055622 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:40:16.056101 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:40:16.057273 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:40:16.275807 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
17:40:16.286106 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
17:40:16.333959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663b831f-73a5-44e9-b320-3f19e694da56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c3b7ac0>]}
17:40:16.342586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663b831f-73a5-44e9-b320-3f19e694da56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c388280>]}
17:40:16.342993 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:40:16.346013 [info ] [MainThread]: 
17:40:16.346850 [debug] [MainThread]: Acquiring new postgres connection "master"
17:40:16.347647 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:40:16.356873 [debug] [ThreadPool]: Using postgres connection "list_master"
17:40:16.357153 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:40:16.357309 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:40:16.697706 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.34 seconds
17:40:16.702026 [debug] [ThreadPool]: On list_master: Close
17:40:16.703289 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
17:40:16.709343 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:40:16.717901 [debug] [ThreadPool]: On list_master_public: BEGIN
17:40:16.718156 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:40:16.728653 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:40:16.728925 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:40:16.729063 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:40:16.768099 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.04 seconds
17:40:16.769212 [debug] [ThreadPool]: On list_master_public: ROLLBACK
17:40:16.769467 [debug] [ThreadPool]: On list_master_public: Close
17:40:16.772995 [debug] [MainThread]: Using postgres connection "master"
17:40:16.773189 [debug] [MainThread]: On master: BEGIN
17:40:16.773282 [debug] [MainThread]: Opening a new connection, currently in state init
17:40:16.785483 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:40:16.785744 [debug] [MainThread]: Using postgres connection "master"
17:40:16.785878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:40:16.802519 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
17:40:16.804121 [debug] [MainThread]: On master: ROLLBACK
17:40:16.804440 [debug] [MainThread]: Using postgres connection "master"
17:40:16.804575 [debug] [MainThread]: On master: BEGIN
17:40:16.805001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:40:16.805148 [debug] [MainThread]: On master: COMMIT
17:40:16.805266 [debug] [MainThread]: Using postgres connection "master"
17:40:16.805372 [debug] [MainThread]: On master: COMMIT
17:40:16.805553 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:40:16.805687 [debug] [MainThread]: On master: Close
17:40:16.806016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:40:16.807641 [info ] [MainThread]: 
17:40:16.847788 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
17:40:16.857173 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
17:40:16.858543 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
17:40:16.858678 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
17:40:16.858794 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
17:40:16.861058 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
17:40:16.877234 [debug] [Thread-1  ]: finished collecting timing info
17:40:16.877482 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
17:40:16.926630 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
17:40:16.933509 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:40:16.933729 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
17:40:16.933822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:40:16.947822 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:40:16.948025 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:40:16.948120 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:40:16.996031 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.05 seconds
17:40:17.001209 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:40:17.001412 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:40:17.005499 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:40:17.014356 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:40:17.014559 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:40:17.014656 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:40:17.067990 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
17:40:17.072290 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:40:17.072558 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
17:40:17.073708 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:40:17.074792 [debug] [Thread-1  ]: finished collecting timing info
17:40:17.074980 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
17:40:17.076735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663b831f-73a5-44e9-b320-3f19e694da56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c3c8a00>]}
17:40:17.077192 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.22s]
17:40:17.078056 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
17:40:17.078666 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
17:40:17.078910 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
17:40:17.079579 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
17:40:17.079726 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
17:40:17.079853 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
17:40:17.085967 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
17:40:17.086886 [debug] [Thread-1  ]: finished collecting timing info
17:40:17.087075 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
17:40:17.107061 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
17:40:17.116112 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:40:17.116338 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
17:40:17.116431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:40:17.137019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:40:17.137231 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:40:17.137350 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
17:40:17.164192 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
17:40:17.166338 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:40:17.166488 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:40:17.166981 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:40:17.167899 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:40:17.168018 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:40:17.168105 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:40:17.178831 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:40:17.180340 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:40:17.180515 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
17:40:17.180836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:40:17.181752 [debug] [Thread-1  ]: finished collecting timing info
17:40:17.181890 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
17:40:17.187085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663b831f-73a5-44e9-b320-3f19e694da56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86f79e20>]}
17:40:17.190904 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.11s]
17:40:17.194341 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
17:40:17.195268 [debug] [MainThread]: Acquiring new postgres connection "master"
17:40:17.195438 [debug] [MainThread]: Using postgres connection "master"
17:40:17.195531 [debug] [MainThread]: On master: BEGIN
17:40:17.195613 [debug] [MainThread]: Opening a new connection, currently in state closed
17:40:17.208264 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:40:17.208523 [debug] [MainThread]: On master: COMMIT
17:40:17.211870 [debug] [MainThread]: Using postgres connection "master"
17:40:17.212032 [debug] [MainThread]: On master: COMMIT
17:40:17.212289 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:40:17.212416 [debug] [MainThread]: On master: Close
17:40:17.217249 [info ] [MainThread]: 
17:40:17.217755 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.87s.
17:40:17.218017 [debug] [MainThread]: Connection 'master' was properly closed.
17:40:17.218118 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:40:17.218196 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
17:40:17.234147 [info ] [MainThread]: 
17:40:17.235485 [info ] [MainThread]: [32mCompleted successfully[0m
17:40:17.236832 [info ] [MainThread]: 
17:40:17.237832 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:40:17.238900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c388640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8c092700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86fa3040>]}


============================== 2022-01-04 17:45:15.197666 | b6411aec-76ed-436d-95c7-e315e5e6468d ==============================
17:45:15.197666 [info ] [MainThread]: Running with dbt=1.0.0
17:45:15.213713 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:45:15.214047 [debug] [MainThread]: Tracking: tracking
17:45:15.239566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1add12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1add1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1add1400>]}
17:45:15.410845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:45:15.411099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:45:15.472396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6411aec-76ed-436d-95c7-e315e5e6468d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ada61f0>]}
17:45:15.491663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6411aec-76ed-436d-95c7-e315e5e6468d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ad55940>]}
17:45:15.492048 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:45:15.493606 [info ] [MainThread]: 
17:45:15.494333 [debug] [MainThread]: Acquiring new postgres connection "master"
17:45:15.495193 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:45:15.515246 [debug] [ThreadPool]: Using postgres connection "list_master"
17:45:15.515503 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:45:15.515638 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:45:15.552852 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
17:45:15.555192 [debug] [ThreadPool]: On list_master: Close
17:45:15.566235 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
17:45:15.602147 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:45:15.602348 [debug] [ThreadPool]: On list_master_public: BEGIN
17:45:15.602445 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:45:15.625495 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:45:15.625688 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:45:15.625783 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:45:15.627790 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
17:45:15.628935 [debug] [ThreadPool]: On list_master_public: ROLLBACK
17:45:15.646009 [debug] [ThreadPool]: On list_master_public: Close
17:45:15.650741 [debug] [MainThread]: Using postgres connection "master"
17:45:15.650963 [debug] [MainThread]: On master: BEGIN
17:45:15.651147 [debug] [MainThread]: Opening a new connection, currently in state init
17:45:15.662050 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:45:15.664347 [debug] [MainThread]: Using postgres connection "master"
17:45:15.680288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:45:15.682878 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
17:45:15.688581 [debug] [MainThread]: On master: ROLLBACK
17:45:15.688945 [debug] [MainThread]: Using postgres connection "master"
17:45:15.689053 [debug] [MainThread]: On master: BEGIN
17:45:15.689413 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:45:15.689573 [debug] [MainThread]: On master: COMMIT
17:45:15.689706 [debug] [MainThread]: Using postgres connection "master"
17:45:15.689791 [debug] [MainThread]: On master: COMMIT
17:45:15.689960 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:45:15.690069 [debug] [MainThread]: On master: Close
17:45:15.696911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:45:15.697709 [info ] [MainThread]: 
17:45:15.754132 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
17:45:15.754432 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
17:45:15.755321 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
17:45:15.755466 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
17:45:15.755583 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
17:45:15.757619 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
17:45:15.779038 [debug] [Thread-1  ]: finished collecting timing info
17:45:15.779282 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
17:45:15.856055 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
17:45:15.878587 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:45:15.878779 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
17:45:15.878876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:45:15.886861 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:45:15.887074 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:45:15.887171 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:45:15.889264 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:45:15.893811 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:45:15.893970 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:45:15.912620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:45:15.939107 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:45:15.975058 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:45:15.975276 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:45:15.977704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:45:15.981900 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:45:15.982086 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
17:45:15.997290 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:45:15.998395 [debug] [Thread-1  ]: finished collecting timing info
17:45:15.998552 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
17:45:16.004470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6411aec-76ed-436d-95c7-e315e5e6468d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ac7c190>]}
17:45:16.004839 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.25s]
17:45:16.005328 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
17:45:16.005761 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
17:45:16.010370 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
17:45:16.011071 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
17:45:16.011213 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
17:45:16.011316 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
17:45:16.013503 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
17:45:16.029462 [debug] [Thread-1  ]: finished collecting timing info
17:45:16.029695 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
17:45:16.052854 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
17:45:16.053955 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:45:16.054083 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
17:45:16.054168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:45:16.074110 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:45:16.074326 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:45:16.074427 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
17:45:16.084490 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:45:16.086344 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:45:16.086480 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:45:16.093074 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:45:16.094143 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:45:16.094268 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:45:16.094353 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:45:16.122422 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
17:45:16.123791 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:45:16.123919 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
17:45:16.136618 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
17:45:16.137722 [debug] [Thread-1  ]: finished collecting timing info
17:45:16.137907 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
17:45:16.145762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6411aec-76ed-436d-95c7-e315e5e6468d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ac853a0>]}
17:45:16.146733 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.13s]
17:45:16.148784 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
17:45:16.149946 [debug] [MainThread]: Acquiring new postgres connection "master"
17:45:16.150105 [debug] [MainThread]: Using postgres connection "master"
17:45:16.150198 [debug] [MainThread]: On master: BEGIN
17:45:16.150278 [debug] [MainThread]: Opening a new connection, currently in state closed
17:45:16.179622 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
17:45:16.179873 [debug] [MainThread]: On master: COMMIT
17:45:16.179978 [debug] [MainThread]: Using postgres connection "master"
17:45:16.180068 [debug] [MainThread]: On master: COMMIT
17:45:16.180262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:45:16.180380 [debug] [MainThread]: On master: Close
17:45:16.183012 [info ] [MainThread]: 
17:45:16.184475 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.69s.
17:45:16.185060 [debug] [MainThread]: Connection 'master' was properly closed.
17:45:16.185162 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:45:16.185241 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
17:45:16.189579 [info ] [MainThread]: 
17:45:16.190038 [info ] [MainThread]: [32mCompleted successfully[0m
17:45:16.190396 [info ] [MainThread]: 
17:45:16.190650 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:45:16.190999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ad55580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ac781f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ac78cd0>]}


============================== 2022-01-04 17:51:37.645269 | 84346430-76bc-41ec-adec-4b2a4adba248 ==============================
17:51:37.645269 [info ] [MainThread]: Running with dbt=1.0.0
17:51:37.661388 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:51:37.668879 [debug] [MainThread]: Tracking: tracking
17:51:37.683760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9b427c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9b426a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9b42700>]}
17:51:37.839545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:51:37.858124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:51:37.952331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84346430-76bc-41ec-adec-4b2a4adba248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbb3c6dc0>]}
17:51:37.969718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84346430-76bc-41ec-adec-4b2a4adba248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9b118b0>]}
17:51:37.970100 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:51:37.972040 [info ] [MainThread]: 
17:51:37.972760 [debug] [MainThread]: Acquiring new postgres connection "master"
17:51:37.973495 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:51:37.988931 [debug] [ThreadPool]: Using postgres connection "list_master"
17:51:37.993978 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:51:37.994244 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:51:38.097944 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.1 seconds
17:51:38.099592 [debug] [ThreadPool]: On list_master: Close
17:51:38.106034 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
17:51:38.114873 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:51:38.133788 [debug] [ThreadPool]: On list_master_public: BEGIN
17:51:38.134035 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:51:38.153535 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:51:38.153840 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:51:38.153989 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:51:38.156215 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
17:51:38.157243 [debug] [ThreadPool]: On list_master_public: ROLLBACK
17:51:38.166922 [debug] [ThreadPool]: On list_master_public: Close
17:51:38.172021 [debug] [MainThread]: Using postgres connection "master"
17:51:38.172353 [debug] [MainThread]: On master: BEGIN
17:51:38.172489 [debug] [MainThread]: Opening a new connection, currently in state init
17:51:38.189547 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:51:38.189757 [debug] [MainThread]: Using postgres connection "master"
17:51:38.189878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:51:38.193733 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
17:51:38.216873 [debug] [MainThread]: On master: ROLLBACK
17:51:38.217362 [debug] [MainThread]: Using postgres connection "master"
17:51:38.217511 [debug] [MainThread]: On master: BEGIN
17:51:38.218354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:51:38.218483 [debug] [MainThread]: On master: COMMIT
17:51:38.218575 [debug] [MainThread]: Using postgres connection "master"
17:51:38.218654 [debug] [MainThread]: On master: COMMIT
17:51:38.218804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:51:38.218914 [debug] [MainThread]: On master: Close
17:51:38.220531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:51:38.220859 [info ] [MainThread]: 
17:51:38.336583 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
17:51:38.336939 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
17:51:38.337861 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
17:51:38.338019 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
17:51:38.338136 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
17:51:38.340078 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
17:51:38.341055 [debug] [Thread-1  ]: finished collecting timing info
17:51:38.341227 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
17:51:38.420130 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
17:51:38.454032 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:51:38.454215 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
17:51:38.454307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:51:38.466601 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:51:38.466797 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:51:38.466891 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:51:38.468335 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:51:38.472987 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:51:38.473169 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:51:38.499325 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
17:51:38.515885 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:51:38.539522 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:51:38.539761 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:51:38.542462 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:51:38.546315 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:51:38.546471 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
17:51:38.581983 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
17:51:38.583085 [debug] [Thread-1  ]: finished collecting timing info
17:51:38.583232 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
17:51:38.585026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84346430-76bc-41ec-adec-4b2a4adba248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9a56fd0>]}
17:51:38.585357 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.25s]
17:51:38.585811 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
17:51:38.586254 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
17:51:38.586469 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
17:51:38.586836 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
17:51:38.586945 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
17:51:38.587039 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
17:51:38.588919 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
17:51:38.592768 [debug] [Thread-1  ]: finished collecting timing info
17:51:38.592944 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
17:51:38.639512 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
17:51:38.642388 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:51:38.642559 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
17:51:38.642648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:51:38.680730 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
17:51:38.681064 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:51:38.681178 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
17:51:38.682364 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
17:51:38.684127 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:51:38.684257 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:51:38.684665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:51:38.685580 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:51:38.685708 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:51:38.685793 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:51:38.688617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:51:38.689990 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:51:38.690136 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
17:51:38.690447 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:51:38.691375 [debug] [Thread-1  ]: finished collecting timing info
17:51:38.691523 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
17:51:38.721979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84346430-76bc-41ec-adec-4b2a4adba248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb89da040>]}
17:51:38.722366 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.14s]
17:51:38.724881 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
17:51:38.725682 [debug] [MainThread]: Acquiring new postgres connection "master"
17:51:38.725834 [debug] [MainThread]: Using postgres connection "master"
17:51:38.725940 [debug] [MainThread]: On master: BEGIN
17:51:38.726031 [debug] [MainThread]: Opening a new connection, currently in state closed
17:51:38.737758 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:51:38.737970 [debug] [MainThread]: On master: COMMIT
17:51:38.738064 [debug] [MainThread]: Using postgres connection "master"
17:51:38.738148 [debug] [MainThread]: On master: COMMIT
17:51:38.738304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:51:38.738413 [debug] [MainThread]: On master: Close
17:51:38.741530 [info ] [MainThread]: 
17:51:38.746528 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.77s.
17:51:38.748750 [debug] [MainThread]: Connection 'master' was properly closed.
17:51:38.748906 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:51:38.748998 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
17:51:38.785822 [info ] [MainThread]: 
17:51:38.786598 [info ] [MainThread]: [32mCompleted successfully[0m
17:51:38.787853 [info ] [MainThread]: 
17:51:38.788070 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:51:38.788372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9a47f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbb3a4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9b6dc40>]}


============================== 2022-01-04 20:31:46.903040 | 1da8ed64-d39f-4965-a74f-150b6ec975e3 ==============================
20:31:46.903040 [info ] [MainThread]: Running with dbt=1.0.0
20:31:46.913767 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:31:46.914100 [debug] [MainThread]: Tracking: tracking
20:31:47.193600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce94f02f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce94f02d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce94f02eb0>]}
20:31:47.362256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:31:47.362511 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:31:47.457830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1da8ed64-d39f-4965-a74f-150b6ec975e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce94f51fd0>]}
20:31:47.477178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1da8ed64-d39f-4965-a74f-150b6ec975e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce94ee29d0>]}
20:31:47.479716 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:31:47.481594 [info ] [MainThread]: 
20:31:47.486910 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:47.487832 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
20:31:47.503917 [debug] [ThreadPool]: Using postgres connection "list_master"
20:31:47.504172 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
20:31:47.504303 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:48.011392 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.51 seconds
20:31:48.012637 [debug] [ThreadPool]: On list_master: Close
20:31:48.021934 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
20:31:48.033798 [debug] [ThreadPool]: Using postgres connection "list_master_public"
20:31:48.034270 [debug] [ThreadPool]: On list_master_public: BEGIN
20:31:48.034632 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:48.080662 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
20:31:48.080918 [debug] [ThreadPool]: Using postgres connection "list_master_public"
20:31:48.082271 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:31:48.154758 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.07 seconds
20:31:48.155900 [debug] [ThreadPool]: On list_master_public: ROLLBACK
20:31:48.156179 [debug] [ThreadPool]: On list_master_public: Close
20:31:48.161157 [debug] [MainThread]: Using postgres connection "master"
20:31:48.161349 [debug] [MainThread]: On master: BEGIN
20:31:48.161442 [debug] [MainThread]: Opening a new connection, currently in state init
20:31:48.190176 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
20:31:48.190400 [debug] [MainThread]: Using postgres connection "master"
20:31:48.190508 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:31:48.293802 [debug] [MainThread]: SQL status: SELECT 1 in 0.1 seconds
20:31:48.295034 [debug] [MainThread]: On master: ROLLBACK
20:31:48.298101 [debug] [MainThread]: Using postgres connection "master"
20:31:48.298332 [debug] [MainThread]: On master: BEGIN
20:31:48.298729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:48.298886 [debug] [MainThread]: On master: COMMIT
20:31:48.298982 [debug] [MainThread]: Using postgres connection "master"
20:31:48.299062 [debug] [MainThread]: On master: COMMIT
20:31:48.299227 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:48.299355 [debug] [MainThread]: On master: Close
20:31:48.303250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:31:48.314360 [info ] [MainThread]: 
20:31:48.415909 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
20:31:48.416217 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
20:31:48.420551 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.420766 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
20:31:48.421574 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
20:31:48.423578 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
20:31:48.443889 [debug] [Thread-1  ]: finished collecting timing info
20:31:48.444148 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
20:31:48.524520 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
20:31:48.551093 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.551323 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
20:31:48.551421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:48.561574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:31:48.561791 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.561890 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:31:48.767915 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.21 seconds
20:31:48.772854 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.773041 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:31:48.774877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:48.777574 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.777797 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:31:48.778245 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:48.790343 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
20:31:48.790596 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.790723 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
20:31:48.798628 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:31:48.802616 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:31:48.803210 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
20:31:48.869990 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.07 seconds
20:31:48.871595 [debug] [Thread-1  ]: finished collecting timing info
20:31:48.871827 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
20:31:48.872258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da8ed64-d39f-4965-a74f-150b6ec975e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9455b3a0>]}
20:31:48.872562 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.45s]
20:31:48.873412 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
20:31:48.873894 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
20:31:48.876500 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
20:31:48.878782 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
20:31:48.879037 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
20:31:48.879185 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
20:31:48.881338 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
20:31:48.882532 [debug] [Thread-1  ]: finished collecting timing info
20:31:48.882705 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
20:31:48.912986 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
20:31:48.914701 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:31:48.914908 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
20:31:48.915029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:48.923469 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:31:48.923726 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:31:48.923870 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
20:31:49.002114 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.08 seconds
20:31:49.004073 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:31:49.004221 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:31:49.013775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:31:49.017865 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
20:31:49.018040 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:31:49.018133 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
20:31:49.032955 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:31:49.034384 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:31:49.034519 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
20:31:49.034835 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:31:49.035715 [debug] [Thread-1  ]: finished collecting timing info
20:31:49.035847 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
20:31:49.045880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da8ed64-d39f-4965-a74f-150b6ec975e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce945b0190>]}
20:31:49.046453 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.17s]
20:31:49.046979 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
20:31:49.047756 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:49.047942 [debug] [MainThread]: Using postgres connection "master"
20:31:49.048043 [debug] [MainThread]: On master: BEGIN
20:31:49.048124 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:49.065708 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
20:31:49.065935 [debug] [MainThread]: On master: COMMIT
20:31:49.066034 [debug] [MainThread]: Using postgres connection "master"
20:31:49.066121 [debug] [MainThread]: On master: COMMIT
20:31:49.066296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:49.066431 [debug] [MainThread]: On master: Close
20:31:49.068312 [info ] [MainThread]: 
20:31:49.069007 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.59s.
20:31:49.069437 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:49.069568 [debug] [MainThread]: Connection 'list_master' was properly closed.
20:31:49.069675 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
20:31:49.081394 [info ] [MainThread]: 
20:31:49.082115 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:49.083325 [info ] [MainThread]: 
20:31:49.083771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
20:31:49.086484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce94ee24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce945960d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce967e78b0>]}


============================== 2022-01-04 20:34:44.474333 | fd28697b-ca88-4705-824c-2eeadefc7e7a ==============================
20:34:44.474333 [info ] [MainThread]: Running with dbt=1.0.0
20:34:44.493829 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:34:44.494355 [debug] [MainThread]: Tracking: tracking
20:34:44.585787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ab18efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ab18ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ab18eee0>]}
20:34:44.694952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:34:44.695231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:34:44.782682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd28697b-ca88-4705-824c-2eeadefc7e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b01fff70>]}
20:34:44.802664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd28697b-ca88-4705-824c-2eeadefc7e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ab173a00>]}
20:34:44.802974 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:34:44.804938 [info ] [MainThread]: 
20:34:44.806025 [debug] [MainThread]: Acquiring new postgres connection "master"
20:34:44.806860 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
20:34:44.815581 [debug] [ThreadPool]: Using postgres connection "list_master"
20:34:44.821721 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
20:34:44.821983 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:44.863836 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
20:34:44.865001 [debug] [ThreadPool]: On list_master: Close
20:34:44.867604 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
20:34:44.872288 [debug] [ThreadPool]: Using postgres connection "list_master_public"
20:34:44.872450 [debug] [ThreadPool]: On list_master_public: BEGIN
20:34:44.872541 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:34:44.914768 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
20:34:44.914999 [debug] [ThreadPool]: Using postgres connection "list_master_public"
20:34:44.915094 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:34:44.917483 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
20:34:44.918565 [debug] [ThreadPool]: On list_master_public: ROLLBACK
20:34:44.929673 [debug] [ThreadPool]: On list_master_public: Close
20:34:44.934736 [debug] [MainThread]: Using postgres connection "master"
20:34:44.934918 [debug] [MainThread]: On master: BEGIN
20:34:44.935008 [debug] [MainThread]: Opening a new connection, currently in state init
20:34:44.964935 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
20:34:44.965151 [debug] [MainThread]: Using postgres connection "master"
20:34:44.965246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:34:44.981703 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
20:34:44.982825 [debug] [MainThread]: On master: ROLLBACK
20:34:44.994639 [debug] [MainThread]: Using postgres connection "master"
20:34:44.994894 [debug] [MainThread]: On master: BEGIN
20:34:44.996010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:34:44.996251 [debug] [MainThread]: On master: COMMIT
20:34:44.996349 [debug] [MainThread]: Using postgres connection "master"
20:34:44.996433 [debug] [MainThread]: On master: COMMIT
20:34:44.996622 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:34:44.996738 [debug] [MainThread]: On master: Close
20:34:44.997070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:34:45.005991 [info ] [MainThread]: 
20:34:45.052255 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
20:34:45.052577 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
20:34:45.053112 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.053231 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
20:34:45.053342 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
20:34:45.055158 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
20:34:45.078891 [debug] [Thread-1  ]: finished collecting timing info
20:34:45.079155 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
20:34:45.163719 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
20:34:45.196535 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.196767 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
20:34:45.196864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:45.203866 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:34:45.204074 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.204165 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:34:45.205478 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
20:34:45.216311 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.244506 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:34:45.245211 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:34:45.247730 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.247915 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:34:45.253414 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:34:45.295928 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
20:34:45.296163 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.296262 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
20:34:45.307543 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:34:45.311826 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
20:34:45.312039 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
20:34:45.325321 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
20:34:45.326525 [debug] [Thread-1  ]: finished collecting timing info
20:34:45.326704 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
20:34:45.337528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd28697b-ca88-4705-824c-2eeadefc7e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3aa0272b0>]}
20:34:45.337915 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.28s]
20:34:45.349058 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
20:34:45.349629 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
20:34:45.349831 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
20:34:45.350678 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
20:34:45.350814 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
20:34:45.350916 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
20:34:45.352851 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
20:34:45.354713 [debug] [Thread-1  ]: finished collecting timing info
20:34:45.354892 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
20:34:45.386411 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
20:34:45.397070 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:34:45.397291 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
20:34:45.397394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:34:45.433717 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
20:34:45.433929 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:34:45.434026 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
20:34:45.435196 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:34:45.437013 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:34:45.437154 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:34:45.456498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
20:34:45.457608 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
20:34:45.457756 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:34:45.457852 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
20:34:45.459803 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:34:45.461289 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
20:34:45.461468 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
20:34:45.461822 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:34:45.462728 [debug] [Thread-1  ]: finished collecting timing info
20:34:45.462864 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
20:34:45.465130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd28697b-ca88-4705-824c-2eeadefc7e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ab1c6c10>]}
20:34:45.465455 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.11s]
20:34:45.489059 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
20:34:45.489960 [debug] [MainThread]: Acquiring new postgres connection "master"
20:34:45.490117 [debug] [MainThread]: Using postgres connection "master"
20:34:45.490207 [debug] [MainThread]: On master: BEGIN
20:34:45.490286 [debug] [MainThread]: Opening a new connection, currently in state closed
20:34:45.503043 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:34:45.503261 [debug] [MainThread]: On master: COMMIT
20:34:45.503356 [debug] [MainThread]: Using postgres connection "master"
20:34:45.503439 [debug] [MainThread]: On master: COMMIT
20:34:45.503620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:34:45.503737 [debug] [MainThread]: On master: Close
20:34:45.505977 [info ] [MainThread]: 
20:34:45.506562 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.70s.
20:34:45.506967 [debug] [MainThread]: Connection 'master' was properly closed.
20:34:45.507095 [debug] [MainThread]: Connection 'list_master' was properly closed.
20:34:45.507200 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
20:34:45.531976 [info ] [MainThread]: 
20:34:45.532382 [info ] [MainThread]: [32mCompleted successfully[0m
20:34:45.532738 [info ] [MainThread]: 
20:34:45.532968 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
20:34:45.533275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ab1d9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3aa020b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a9fda580>]}


============================== 2022-01-04 21:08:50.525408 | b2cbbaf0-b5b9-44b7-a83c-6c2bf2679597 ==============================
21:08:50.525408 [info ] [MainThread]: Running with dbt=1.0.0
21:08:50.526684 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
21:08:50.526898 [debug] [MainThread]: Tracking: tracking
21:08:50.585415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e8a46f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e8a46d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e8a46e20>]}
21:08:50.778063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:08:50.788689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:08:50.873767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2cbbaf0-b5b9-44b7-a83c-6c2bf2679597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e8a831f0>]}
21:08:50.893599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2cbbaf0-b5b9-44b7-a83c-6c2bf2679597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e8a24940>]}
21:08:50.893966 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:08:50.895862 [info ] [MainThread]: 
21:08:50.897143 [debug] [MainThread]: Acquiring new postgres connection "master"
21:08:50.897987 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
21:08:50.932234 [debug] [ThreadPool]: Using postgres connection "list_master"
21:08:50.938816 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
21:08:50.939052 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:50.971308 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "postgres" (172.23.0.2), port 5432 failed: FATAL:  password authentication failed for user "pgadmin"
'
21:08:50.971723 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
21:08:50.971911 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
21:08:50.972049 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
21:08:50.972133 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
21:08:50.972239 [debug] [ThreadPool]: On list_master: No close available on handle
21:08:50.987295 [debug] [MainThread]: Connection 'master' was properly closed.
21:08:50.987522 [debug] [MainThread]: Connection 'list_master' was properly closed.
21:08:50.989809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e896fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e896fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e896f5b0>]}


============================== 2022-01-04 22:42:15.659826 | 88e4e041-5e12-4895-b0f2-7eb266a8ff8a ==============================
22:42:15.659826 [info ] [MainThread]: Running with dbt=1.0.0
22:42:15.690891 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:42:15.691150 [debug] [MainThread]: Tracking: tracking
22:42:16.125878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70cc2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70cc2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70cc2ee0>]}
22:42:17.133697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:42:17.133886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:42:17.328205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88e4e041-5e12-4895-b0f2-7eb266a8ff8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70c99b20>]}
22:42:17.371109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88e4e041-5e12-4895-b0f2-7eb266a8ff8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70c99670>]}
22:42:17.371469 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:42:17.373115 [info ] [MainThread]: 
22:42:17.373529 [debug] [MainThread]: Acquiring new postgres connection "master"
22:42:17.408308 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
22:42:17.450033 [debug] [ThreadPool]: Using postgres connection "list_master"
22:42:17.450226 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
22:42:17.450319 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:42:18.022489 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "postgres" (172.23.0.2), port 5432 failed: FATAL:  password authentication failed for user "pgadmin"
'
22:42:18.022717 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
22:42:18.022806 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
22:42:18.022932 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
22:42:18.023011 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
22:42:18.023113 [debug] [ThreadPool]: On list_master: No close available on handle
22:42:18.023557 [debug] [MainThread]: Connection 'master' was properly closed.
22:42:18.023657 [debug] [MainThread]: Connection 'list_master' was properly closed.
22:42:18.024294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d72514b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70c0c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d70c0c4f0>]}


============================== 2022-01-05 00:27:26.078645 | b873bfdd-d92a-4d61-ae5d-7c6c1a991cfa ==============================
00:27:26.078645 [info ] [MainThread]: Running with dbt=1.0.0
00:27:26.079833 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:27:26.080103 [debug] [MainThread]: Tracking: tracking
00:27:26.279894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28913b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28913c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28913c10>]}
00:27:26.385228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:27:26.385498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:27:26.455481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b873bfdd-d92a-4d61-ae5d-7c6c1a991cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e288fb4f0>]}
00:27:26.471703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b873bfdd-d92a-4d61-ae5d-7c6c1a991cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e288fb970>]}
00:27:26.472213 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:27:26.474056 [info ] [MainThread]: 
00:27:26.475174 [debug] [MainThread]: Acquiring new postgres connection "master"
00:27:26.476333 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
00:27:26.484900 [debug] [ThreadPool]: Using postgres connection "list_master"
00:27:26.485253 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
00:27:26.489096 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:27:26.758332 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "postgres" (172.23.0.2), port 5432 failed: FATAL:  password authentication failed for user "pgadmin"
'
00:27:26.758669 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
00:27:26.759184 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
00:27:26.759334 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
00:27:26.759420 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
00:27:26.759530 [debug] [ThreadPool]: On list_master: No close available on handle
00:27:26.761033 [debug] [MainThread]: Connection 'master' was properly closed.
00:27:26.761184 [debug] [MainThread]: Connection 'list_master' was properly closed.
00:27:26.762092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2886ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2886e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2886e6a0>]}


============================== 2022-01-05 00:36:39.033043 | bf862828-54a6-4a45-b86e-1d4bff897f9d ==============================
00:36:39.033043 [info ] [MainThread]: Running with dbt=1.0.0
00:36:39.036775 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:36:39.037200 [debug] [MainThread]: Tracking: tracking
00:36:39.052107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17e5d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17e5d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17e5d700>]}
00:36:39.071914 [info ] [MainThread]: Unable to do partial parsing because profile has changed
00:36:39.090482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf862828-54a6-4a45-b86e-1d4bff897f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17e4e5b0>]}
00:36:39.101864 [debug] [MainThread]: Parsing macros/relations.sql
00:36:39.170633 [debug] [MainThread]: Parsing macros/adapters.sql
00:36:39.193256 [debug] [MainThread]: Parsing macros/catalog.sql
00:36:39.195250 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:36:39.196695 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:36:39.200481 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:36:39.207575 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:36:39.211795 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:36:39.220766 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:36:39.223433 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:36:39.232031 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:36:39.234648 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:36:39.240724 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:36:39.242947 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:36:39.244425 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:36:39.246524 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:36:39.247874 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:36:39.252013 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:36:39.254115 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:36:39.256240 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:36:39.266105 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:36:39.281514 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:36:39.291147 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:36:39.296503 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:36:39.310248 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:36:39.314676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:36:39.323388 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:36:39.332972 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:36:39.345849 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:36:39.347313 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:36:39.349784 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:36:39.355653 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:36:39.358010 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:36:39.361015 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:36:39.368172 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:36:39.369466 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:36:39.378384 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:36:39.380074 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:36:39.381631 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:36:39.382643 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:36:39.383451 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:36:39.383961 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:36:39.385168 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:36:39.549592 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
00:36:39.561179 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
00:36:39.617256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf862828-54a6-4a45-b86e-1d4bff897f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17dd7970>]}
00:36:39.623273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf862828-54a6-4a45-b86e-1d4bff897f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17dd7820>]}
00:36:39.623760 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:36:39.626709 [info ] [MainThread]: 
00:36:39.628037 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:39.628828 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
00:36:39.637022 [debug] [ThreadPool]: Using postgres connection "list_master"
00:36:39.637299 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
00:36:39.637431 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:36:39.874172 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.24 seconds
00:36:39.875561 [debug] [ThreadPool]: On list_master: Close
00:36:39.876903 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
00:36:39.881819 [debug] [ThreadPool]: Using postgres connection "list_master_public"
00:36:39.882005 [debug] [ThreadPool]: On list_master_public: BEGIN
00:36:39.882094 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:36:39.898236 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:36:39.898644 [debug] [ThreadPool]: Using postgres connection "list_master_public"
00:36:39.898814 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:36:39.940359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.04 seconds
00:36:39.941456 [debug] [ThreadPool]: On list_master_public: ROLLBACK
00:36:39.941889 [debug] [ThreadPool]: On list_master_public: Close
00:36:39.945791 [debug] [MainThread]: Using postgres connection "master"
00:36:39.946083 [debug] [MainThread]: On master: BEGIN
00:36:39.946214 [debug] [MainThread]: Opening a new connection, currently in state init
00:36:39.953831 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:36:39.955354 [debug] [MainThread]: Using postgres connection "master"
00:36:39.955532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:36:39.975965 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
00:36:39.977568 [debug] [MainThread]: On master: ROLLBACK
00:36:39.977925 [debug] [MainThread]: Using postgres connection "master"
00:36:39.978063 [debug] [MainThread]: On master: BEGIN
00:36:39.978432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:36:39.979895 [debug] [MainThread]: On master: COMMIT
00:36:39.980087 [debug] [MainThread]: Using postgres connection "master"
00:36:39.980207 [debug] [MainThread]: On master: COMMIT
00:36:39.980432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:36:39.980573 [debug] [MainThread]: On master: Close
00:36:39.982250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:36:39.983646 [info ] [MainThread]: 
00:36:40.009864 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
00:36:40.010251 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
00:36:40.011049 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
00:36:40.011438 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
00:36:40.011620 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
00:36:40.013685 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
00:36:40.014823 [debug] [Thread-1  ]: finished collecting timing info
00:36:40.015081 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
00:36:40.037855 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
00:36:40.040300 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
00:36:40.040627 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
00:36:40.040737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:36:40.055838 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:36:40.057282 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
00:36:40.057455 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
00:36:40.088148 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
00:36:40.093938 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
00:36:40.094204 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:36:40.094614 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:40.102867 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
00:36:40.103144 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
00:36:40.103265 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
00:36:40.114500 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:36:40.118421 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
00:36:40.118637 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
00:36:40.119067 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:36:40.120028 [debug] [Thread-1  ]: finished collecting timing info
00:36:40.120202 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
00:36:40.121878 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf862828-54a6-4a45-b86e-1d4bff897f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17e19130>]}
00:36:40.122219 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.11s]
00:36:40.124129 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
00:36:40.125923 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
00:36:40.126287 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
00:36:40.127756 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
00:36:40.127940 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
00:36:40.128075 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
00:36:40.130035 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
00:36:40.130623 [debug] [Thread-1  ]: finished collecting timing info
00:36:40.131232 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
00:36:40.150030 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
00:36:40.150830 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
00:36:40.151155 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
00:36:40.151399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:36:40.170235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:36:40.170586 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
00:36:40.170686 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
00:36:40.177209 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
00:36:40.183105 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
00:36:40.183334 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:36:40.188417 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:40.189514 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
00:36:40.189646 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
00:36:40.189732 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
00:36:40.195854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:36:40.197229 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
00:36:40.197364 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
00:36:40.201569 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:40.202686 [debug] [Thread-1  ]: finished collecting timing info
00:36:40.202841 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
00:36:40.206962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf862828-54a6-4a45-b86e-1d4bff897f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c16869fa0>]}
00:36:40.207386 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.08s]
00:36:40.210558 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
00:36:40.211679 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:40.211889 [debug] [MainThread]: Using postgres connection "master"
00:36:40.212015 [debug] [MainThread]: On master: BEGIN
00:36:40.212123 [debug] [MainThread]: Opening a new connection, currently in state closed
00:36:40.223352 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:36:40.223629 [debug] [MainThread]: On master: COMMIT
00:36:40.223750 [debug] [MainThread]: Using postgres connection "master"
00:36:40.223860 [debug] [MainThread]: On master: COMMIT
00:36:40.224831 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:36:40.225635 [debug] [MainThread]: On master: Close
00:36:40.226531 [info ] [MainThread]: 
00:36:40.227430 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.60s.
00:36:40.228915 [debug] [MainThread]: Connection 'master' was properly closed.
00:36:40.229101 [debug] [MainThread]: Connection 'list_master' was properly closed.
00:36:40.229212 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
00:36:40.239770 [info ] [MainThread]: 
00:36:40.240999 [info ] [MainThread]: [32mCompleted successfully[0m
00:36:40.243076 [info ] [MainThread]: 
00:36:40.243885 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
00:36:40.244991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17dd75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1796e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c17e0d160>]}


============================== 2022-01-05 01:03:21.042863 | a2a04dd2-a549-4220-a89f-e07a50cfca74 ==============================
01:03:21.042863 [info ] [MainThread]: Running with dbt=1.0.0
01:03:21.047135 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
01:03:21.048032 [debug] [MainThread]: Tracking: tracking
01:03:21.335097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25679be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25679cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25679c70>]}
01:03:21.753462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
01:03:21.753693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
01:03:21.853939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a04dd2-a549-4220-a89f-e07a50cfca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25653ac0>]}
01:03:21.867762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a04dd2-a549-4220-a89f-e07a50cfca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2561d0d0>]}
01:03:21.868183 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:03:21.870350 [info ] [MainThread]: 
01:03:21.871322 [debug] [MainThread]: Acquiring new postgres connection "master"
01:03:21.872718 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
01:03:21.890187 [debug] [ThreadPool]: Using postgres connection "list_master"
01:03:21.890455 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
01:03:21.891580 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:03:22.567244 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.68 seconds
01:03:22.568373 [debug] [ThreadPool]: On list_master: Close
01:03:22.571355 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
01:03:22.576695 [debug] [ThreadPool]: Using postgres connection "list_master_public"
01:03:22.576896 [debug] [ThreadPool]: On list_master_public: BEGIN
01:03:22.576997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
01:03:22.622971 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
01:03:22.623702 [debug] [ThreadPool]: Using postgres connection "list_master_public"
01:03:22.623817 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
01:03:22.743274 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.12 seconds
01:03:22.747233 [debug] [ThreadPool]: On list_master_public: ROLLBACK
01:03:22.747582 [debug] [ThreadPool]: On list_master_public: Close
01:03:22.756210 [debug] [MainThread]: Using postgres connection "master"
01:03:22.756399 [debug] [MainThread]: On master: BEGIN
01:03:22.756484 [debug] [MainThread]: Opening a new connection, currently in state init
01:03:22.777785 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
01:03:22.778000 [debug] [MainThread]: Using postgres connection "master"
01:03:22.778720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
01:03:22.897437 [debug] [MainThread]: SQL status: SELECT 1 in 0.12 seconds
01:03:22.899143 [debug] [MainThread]: On master: ROLLBACK
01:03:22.899929 [debug] [MainThread]: Using postgres connection "master"
01:03:22.900099 [debug] [MainThread]: On master: BEGIN
01:03:22.904301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
01:03:22.904544 [debug] [MainThread]: On master: COMMIT
01:03:22.904661 [debug] [MainThread]: Using postgres connection "master"
01:03:22.904754 [debug] [MainThread]: On master: COMMIT
01:03:22.904953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
01:03:22.905064 [debug] [MainThread]: On master: Close
01:03:22.905376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
01:03:22.905779 [info ] [MainThread]: 
01:03:22.933555 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
01:03:22.933841 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
01:03:22.934306 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:22.934413 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
01:03:22.934990 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
01:03:22.937153 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
01:03:22.938108 [debug] [Thread-1  ]: finished collecting timing info
01:03:22.938258 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
01:03:22.973088 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
01:03:22.974089 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:22.974205 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
01:03:22.976342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
01:03:23.002209 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
01:03:23.003083 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:23.003387 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
01:03:23.223975 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.22 seconds
01:03:23.230667 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:23.230861 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
01:03:23.231239 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
01:03:23.233879 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:23.234021 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
01:03:23.234356 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
01:03:23.251224 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
01:03:23.251430 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:23.251521 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
01:03:23.254178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
01:03:23.258129 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
01:03:23.258301 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
01:03:23.357700 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.1 seconds
01:03:23.363247 [debug] [Thread-1  ]: finished collecting timing info
01:03:23.363455 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
01:03:23.364424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a04dd2-a549-4220-a89f-e07a50cfca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2553ae80>]}
01:03:23.364750 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.43s]
01:03:23.367088 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
01:03:23.370778 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
01:03:23.371150 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
01:03:23.372770 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
01:03:23.372925 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
01:03:23.373027 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
01:03:23.375323 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
01:03:23.375752 [debug] [Thread-1  ]: finished collecting timing info
01:03:23.375869 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
01:03:23.394755 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
01:03:23.398455 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
01:03:23.399163 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
01:03:23.399855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
01:03:23.416276 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
01:03:23.416667 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
01:03:23.416764 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
01:03:23.433084 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
01:03:23.435096 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
01:03:23.435271 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
01:03:23.444753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
01:03:23.446082 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
01:03:23.446245 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
01:03:23.446330 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
01:03:23.453383 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
01:03:23.454745 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
01:03:23.454879 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
01:03:23.455184 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
01:03:23.456051 [debug] [Thread-1  ]: finished collecting timing info
01:03:23.456182 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
01:03:23.458977 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a04dd2-a549-4220-a89f-e07a50cfca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2565f160>]}
01:03:23.459310 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.09s]
01:03:23.459660 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
01:03:23.464566 [debug] [MainThread]: Acquiring new postgres connection "master"
01:03:23.464760 [debug] [MainThread]: Using postgres connection "master"
01:03:23.464851 [debug] [MainThread]: On master: BEGIN
01:03:23.464926 [debug] [MainThread]: Opening a new connection, currently in state closed
01:03:23.483158 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
01:03:23.484012 [debug] [MainThread]: On master: COMMIT
01:03:23.484758 [debug] [MainThread]: Using postgres connection "master"
01:03:23.484869 [debug] [MainThread]: On master: COMMIT
01:03:23.486734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
01:03:23.486919 [debug] [MainThread]: On master: Close
01:03:23.488046 [info ] [MainThread]: 
01:03:23.489258 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.62s.
01:03:23.491624 [debug] [MainThread]: Connection 'master' was properly closed.
01:03:23.491828 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
01:03:23.498750 [info ] [MainThread]: 
01:03:23.499056 [info ] [MainThread]: [32mCompleted successfully[0m
01:03:23.499474 [info ] [MainThread]: 
01:03:23.499856 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
01:03:23.500311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f244d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25516f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f24489e80>]}


============================== 2022-01-06 13:23:01.282033 | 8efa8b69-0b74-444d-8531-b5643f7f0e6e ==============================
13:23:01.282033 [info ] [MainThread]: Running with dbt=1.0.0
13:23:01.282872 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:23:01.283101 [debug] [MainThread]: Tracking: tracking
13:23:01.287663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd725b66f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd725b66d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd725b66e20>]}
13:23:01.336981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:23:01.337423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:23:01.402690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8efa8b69-0b74-444d-8531-b5643f7f0e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd725b981f0>]}
13:23:01.410027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8efa8b69-0b74-444d-8531-b5643f7f0e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd725b4b940>]}
13:23:01.410621 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:23:01.411915 [info ] [MainThread]: 
13:23:01.412430 [debug] [MainThread]: Acquiring new postgres connection "master"
13:23:01.413830 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
13:23:01.429052 [debug] [ThreadPool]: Using postgres connection "list_master"
13:23:01.429318 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
13:23:01.429455 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:23:01.678574 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.25 seconds
13:23:01.679787 [debug] [ThreadPool]: On list_master: Close
13:23:01.681114 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
13:23:01.685948 [debug] [ThreadPool]: Using postgres connection "list_master_public"
13:23:01.687424 [debug] [ThreadPool]: On list_master_public: BEGIN
13:23:01.687693 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:23:01.705296 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
13:23:01.706429 [debug] [ThreadPool]: Using postgres connection "list_master_public"
13:23:01.706876 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
13:23:01.769980 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.06 seconds
13:23:01.771141 [debug] [ThreadPool]: On list_master_public: ROLLBACK
13:23:01.771475 [debug] [ThreadPool]: On list_master_public: Close
13:23:01.785753 [debug] [MainThread]: Using postgres connection "master"
13:23:01.785952 [debug] [MainThread]: On master: BEGIN
13:23:01.786073 [debug] [MainThread]: Opening a new connection, currently in state init
13:23:01.802546 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
13:23:01.802836 [debug] [MainThread]: Using postgres connection "master"
13:23:01.802950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:23:01.827381 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
13:23:01.828579 [debug] [MainThread]: On master: ROLLBACK
13:23:01.828935 [debug] [MainThread]: Using postgres connection "master"
13:23:01.829129 [debug] [MainThread]: On master: BEGIN
13:23:01.829762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:23:01.831482 [debug] [MainThread]: On master: COMMIT
13:23:01.831713 [debug] [MainThread]: Using postgres connection "master"
13:23:01.831891 [debug] [MainThread]: On master: COMMIT
13:23:01.832192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:23:01.832377 [debug] [MainThread]: On master: Close
13:23:01.833183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:23:01.837178 [info ] [MainThread]: 
13:23:01.914376 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
13:23:01.914731 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
13:23:01.915264 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:01.916003 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
13:23:01.916153 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
13:23:01.919665 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
13:23:01.922955 [debug] [Thread-1  ]: finished collecting timing info
13:23:01.924410 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
13:23:01.968481 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
13:23:01.970723 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:01.971140 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
13:23:01.971324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:01.981720 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
13:23:01.982024 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:01.982198 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
13:23:02.057601 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.08 seconds
13:23:02.062833 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:02.063132 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
13:23:02.072207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
13:23:02.078532 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:02.079237 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
13:23:02.080021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
13:23:02.091006 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
13:23:02.091358 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:02.091562 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
13:23:02.109868 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
13:23:02.115685 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
13:23:02.115952 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
13:23:02.127069 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
13:23:02.129369 [debug] [Thread-1  ]: finished collecting timing info
13:23:02.129795 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
13:23:02.130361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8efa8b69-0b74-444d-8531-b5643f7f0e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7249be340>]}
13:23:02.130726 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.22s]
13:23:02.131117 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
13:23:02.137149 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
13:23:02.137546 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
13:23:02.145835 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
13:23:02.146093 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
13:23:02.146212 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
13:23:02.149405 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
13:23:02.150591 [debug] [Thread-1  ]: finished collecting timing info
13:23:02.150818 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
13:23:02.169761 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
13:23:02.171120 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
13:23:02.171345 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
13:23:02.171449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:23:02.202324 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
13:23:02.202634 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
13:23:02.202736 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
13:23:02.208191 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
13:23:02.210777 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
13:23:02.211167 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
13:23:02.221858 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
13:23:02.223400 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
13:23:02.223807 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
13:23:02.224241 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
13:23:02.227441 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
13:23:02.228827 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
13:23:02.229500 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
13:23:02.231097 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
13:23:02.232339 [debug] [Thread-1  ]: finished collecting timing info
13:23:02.232599 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
13:23:02.233084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8efa8b69-0b74-444d-8531-b5643f7f0e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd725bb0100>]}
13:23:02.233618 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.09s]
13:23:02.234005 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
13:23:02.244074 [debug] [MainThread]: Acquiring new postgres connection "master"
13:23:02.244347 [debug] [MainThread]: Using postgres connection "master"
13:23:02.244458 [debug] [MainThread]: On master: BEGIN
13:23:02.244541 [debug] [MainThread]: Opening a new connection, currently in state closed
13:23:02.264752 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
13:23:02.264971 [debug] [MainThread]: On master: COMMIT
13:23:02.265066 [debug] [MainThread]: Using postgres connection "master"
13:23:02.265152 [debug] [MainThread]: On master: COMMIT
13:23:02.265668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:23:02.266125 [debug] [MainThread]: On master: Close
13:23:02.267879 [info ] [MainThread]: 
13:23:02.268197 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.86s.
13:23:02.268939 [debug] [MainThread]: Connection 'master' was properly closed.
13:23:02.269050 [debug] [MainThread]: Connection 'list_master' was properly closed.
13:23:02.269132 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
13:23:02.287234 [info ] [MainThread]: 
13:23:02.293214 [info ] [MainThread]: [32mCompleted successfully[0m
13:23:02.294362 [info ] [MainThread]: 
13:23:02.295121 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
13:23:02.295947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7249f9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7249f9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7273d3d30>]}


============================== 2022-01-06 17:32:31.300160 | 224eff9b-47ba-4d47-8c8a-8835a7313d31 ==============================
17:32:31.300160 [info ] [MainThread]: Running with dbt=1.0.0
17:32:31.300942 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:32:31.301353 [debug] [MainThread]: Tracking: tracking
17:32:31.494732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e262e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e262e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e262e700>]}
17:32:31.618538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:32:31.619080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:32:31.688299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '224eff9b-47ba-4d47-8c8a-8835a7313d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e3eb10a0>]}
17:32:31.695485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '224eff9b-47ba-4d47-8c8a-8835a7313d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e25fb8e0>]}
17:32:31.696209 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:32:31.698142 [info ] [MainThread]: 
17:32:31.699478 [debug] [MainThread]: Acquiring new postgres connection "master"
17:32:31.700542 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:32:31.717058 [debug] [ThreadPool]: Using postgres connection "list_master"
17:32:31.717349 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:32:31.717511 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:32:32.234408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.52 seconds
17:32:32.235891 [debug] [ThreadPool]: On list_master: Close
17:32:32.237990 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
17:32:32.244522 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:32:32.244849 [debug] [ThreadPool]: On list_master_public: BEGIN
17:32:32.244973 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:32:32.265615 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:32:32.266447 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:32:32.266627 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:32:32.341143 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.07 seconds
17:32:32.357655 [debug] [ThreadPool]: On list_master_public: ROLLBACK
17:32:32.358271 [debug] [ThreadPool]: On list_master_public: Close
17:32:32.366695 [debug] [MainThread]: Using postgres connection "master"
17:32:32.367212 [debug] [MainThread]: On master: BEGIN
17:32:32.367407 [debug] [MainThread]: Opening a new connection, currently in state init
17:32:32.378728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:32:32.379096 [debug] [MainThread]: Using postgres connection "master"
17:32:32.379227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:32:32.421088 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
17:32:32.423648 [debug] [MainThread]: On master: ROLLBACK
17:32:32.424825 [debug] [MainThread]: Using postgres connection "master"
17:32:32.425161 [debug] [MainThread]: On master: BEGIN
17:32:32.429879 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:32:32.434332 [debug] [MainThread]: On master: COMMIT
17:32:32.434524 [debug] [MainThread]: Using postgres connection "master"
17:32:32.434649 [debug] [MainThread]: On master: COMMIT
17:32:32.434923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:32:32.435074 [debug] [MainThread]: On master: Close
17:32:32.437790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:32:32.439186 [info ] [MainThread]: 
17:32:32.483758 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
17:32:32.484664 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
17:32:32.486931 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.487443 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
17:32:32.488240 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
17:32:32.492810 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
17:32:32.494299 [debug] [Thread-1  ]: finished collecting timing info
17:32:32.494500 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
17:32:32.525717 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
17:32:32.527118 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.527356 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
17:32:32.527471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:32:32.557430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:32:32.558700 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.558873 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:32:32.619451 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.06 seconds
17:32:32.627475 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.627891 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:32:32.629648 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:32:32.633066 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.633420 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:32:32.634770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:32:32.646727 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:32:32.647001 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.647167 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:32:32.661529 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:32:32.665811 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:32:32.666023 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
17:32:32.678448 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:32:32.679600 [debug] [Thread-1  ]: finished collecting timing info
17:32:32.679794 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
17:32:32.680929 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '224eff9b-47ba-4d47-8c8a-8835a7313d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e14c91f0>]}
17:32:32.681255 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.20s]
17:32:32.681673 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
17:32:32.684135 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
17:32:32.684429 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
17:32:32.685820 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
17:32:32.686059 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
17:32:32.686223 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
17:32:32.689458 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
17:32:32.691032 [debug] [Thread-1  ]: finished collecting timing info
17:32:32.691441 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
17:32:32.708619 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
17:32:32.709904 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:32:32.710163 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
17:32:32.710299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:32:32.720882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:32:32.722808 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:32:32.723014 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
17:32:32.751205 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
17:32:32.753539 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:32:32.754248 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:32:32.760356 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:32:32.761581 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:32:32.761726 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:32:32.761811 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:32:32.764544 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:32:32.765944 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:32:32.766085 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
17:32:32.766503 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:32:32.782130 [debug] [Thread-1  ]: finished collecting timing info
17:32:32.782526 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
17:32:32.785253 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '224eff9b-47ba-4d47-8c8a-8835a7313d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e3e76370>]}
17:32:32.785760 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.10s]
17:32:32.786445 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
17:32:32.788131 [debug] [MainThread]: Acquiring new postgres connection "master"
17:32:32.788690 [debug] [MainThread]: Using postgres connection "master"
17:32:32.789094 [debug] [MainThread]: On master: BEGIN
17:32:32.789233 [debug] [MainThread]: Opening a new connection, currently in state closed
17:32:32.798153 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:32:32.799636 [debug] [MainThread]: On master: COMMIT
17:32:32.799752 [debug] [MainThread]: Using postgres connection "master"
17:32:32.799841 [debug] [MainThread]: On master: COMMIT
17:32:32.800069 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:32:32.800201 [debug] [MainThread]: On master: Close
17:32:32.802133 [info ] [MainThread]: 
17:32:32.802959 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.10s.
17:32:32.812683 [debug] [MainThread]: Connection 'master' was properly closed.
17:32:32.831296 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:32:32.831465 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
17:32:32.838082 [info ] [MainThread]: 
17:32:32.839754 [info ] [MainThread]: [32mCompleted successfully[0m
17:32:32.842262 [info ] [MainThread]: 
17:32:32.843167 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:32:32.846409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e25fb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e146ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e146ec10>]}


============================== 2022-01-06 17:49:49.442921 | 5a282bea-b6a3-41e5-a1d5-b226da1073f4 ==============================
17:49:49.442921 [info ] [MainThread]: Running with dbt=1.0.0
17:49:49.447921 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:49:49.448346 [debug] [MainThread]: Tracking: tracking
17:49:49.537244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa218670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa218fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa218700>]}
17:49:50.481715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:49:50.482036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:49:50.548058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a282bea-b6a3-41e5-a1d5-b226da1073f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa24d100>]}
17:49:50.564551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a282bea-b6a3-41e5-a1d5-b226da1073f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa1fa9d0>]}
17:49:50.566149 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:49:50.576120 [info ] [MainThread]: 
17:49:50.578172 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:50.582513 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:49:50.593883 [debug] [ThreadPool]: Using postgres connection "list_master"
17:49:50.604043 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:49:50.604817 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:49:50.921823 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.32 seconds
17:49:50.926535 [debug] [ThreadPool]: On list_master: Close
17:49:50.929525 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
17:49:50.936066 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:49:50.938434 [debug] [ThreadPool]: On list_master_public: BEGIN
17:49:50.939100 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:49:50.988929 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
17:49:50.989408 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:49:50.989780 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:49:51.080207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.09 seconds
17:49:51.082456 [debug] [ThreadPool]: On list_master_public: ROLLBACK
17:49:51.083181 [debug] [ThreadPool]: On list_master_public: Close
17:49:51.103013 [debug] [MainThread]: Using postgres connection "master"
17:49:51.103282 [debug] [MainThread]: On master: BEGIN
17:49:51.103469 [debug] [MainThread]: Opening a new connection, currently in state init
17:49:51.478187 [debug] [MainThread]: SQL status: BEGIN in 0.37 seconds
17:49:51.478705 [debug] [MainThread]: Using postgres connection "master"
17:49:51.479001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:49:51.615821 [debug] [MainThread]: SQL status: SELECT 1 in 0.14 seconds
17:49:51.617302 [debug] [MainThread]: On master: ROLLBACK
17:49:51.618030 [debug] [MainThread]: Using postgres connection "master"
17:49:51.618503 [debug] [MainThread]: On master: BEGIN
17:49:51.620398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:51.625864 [debug] [MainThread]: On master: COMMIT
17:49:51.626523 [debug] [MainThread]: Using postgres connection "master"
17:49:51.626643 [debug] [MainThread]: On master: COMMIT
17:49:51.627046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:51.627331 [debug] [MainThread]: On master: Close
17:49:51.627809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:49:51.639005 [info ] [MainThread]: 
17:49:51.691019 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
17:49:51.691992 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
17:49:51.698395 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.698686 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
17:49:51.698824 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
17:49:51.702597 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
17:49:51.705276 [debug] [Thread-1  ]: finished collecting timing info
17:49:51.705878 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
17:49:51.743233 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
17:49:51.763673 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.764198 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
17:49:51.764382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:49:51.832961 [debug] [Thread-1  ]: SQL status: BEGIN in 0.07 seconds
17:49:51.833413 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.833658 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:49:51.946151 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.11 seconds
17:49:51.952846 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.954073 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:49:51.957904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:49:51.960854 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.961135 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:49:51.962241 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:49:51.976556 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:49:51.976833 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.976969 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:49:51.990982 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:49:51.995383 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:49:51.995701 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
17:49:52.040346 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
17:49:52.041615 [debug] [Thread-1  ]: finished collecting timing info
17:49:52.041917 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
17:49:52.042400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a282bea-b6a3-41e5-a1d5-b226da1073f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a90ad1c0>]}
17:49:52.043951 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.34s]
17:49:52.044600 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
17:49:52.049801 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
17:49:52.050783 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
17:49:52.055742 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
17:49:52.056605 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
17:49:52.057594 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
17:49:52.059867 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
17:49:52.112241 [debug] [Thread-1  ]: finished collecting timing info
17:49:52.112838 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
17:49:52.156449 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
17:49:52.180964 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:49:52.181709 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
17:49:52.181826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:49:52.204487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:49:52.210875 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:49:52.211055 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
17:49:52.217175 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:49:52.221100 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:49:52.221700 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:49:52.223643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:49:52.227550 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:49:52.227991 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:49:52.228219 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:49:52.230790 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:49:52.233832 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:49:52.234268 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
17:49:52.234808 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:49:52.236358 [debug] [Thread-1  ]: finished collecting timing info
17:49:52.237138 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
17:49:52.242519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a282bea-b6a3-41e5-a1d5-b226da1073f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa10cc40>]}
17:49:52.243220 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.19s]
17:49:52.244107 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
17:49:52.260671 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:52.261004 [debug] [MainThread]: Using postgres connection "master"
17:49:52.261148 [debug] [MainThread]: On master: BEGIN
17:49:52.261236 [debug] [MainThread]: Opening a new connection, currently in state closed
17:49:52.283875 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:49:52.284307 [debug] [MainThread]: On master: COMMIT
17:49:52.284839 [debug] [MainThread]: Using postgres connection "master"
17:49:52.285318 [debug] [MainThread]: On master: COMMIT
17:49:52.286834 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:52.287192 [debug] [MainThread]: On master: Close
17:49:52.291371 [info ] [MainThread]: 
17:49:52.291816 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.71s.
17:49:52.293225 [debug] [MainThread]: Connection 'master' was properly closed.
17:49:52.294561 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:49:52.295633 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
17:49:52.342331 [info ] [MainThread]: 
17:49:52.342751 [info ] [MainThread]: [32mCompleted successfully[0m
17:49:52.343479 [info ] [MainThread]: 
17:49:52.343744 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:49:52.344201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa1fa4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aa10abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a90d5a30>]}


============================== 2022-01-06 17:55:56.078850 | bff5f19b-b187-4d74-a038-81974e247990 ==============================
17:55:56.078850 [info ] [MainThread]: Running with dbt=1.0.0
17:55:56.090333 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:55:56.091064 [debug] [MainThread]: Tracking: tracking
17:55:56.122748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eecd8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eecd8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eecd8fd0>]}
17:55:56.217508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:55:56.218837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:55:56.308278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bff5f19b-b187-4d74-a038-81974e247990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eed0d070>]}
17:55:56.329959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bff5f19b-b187-4d74-a038-81974e247990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eecbb940>]}
17:55:56.330489 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:55:56.332429 [info ] [MainThread]: 
17:55:56.333451 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:56.335219 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
17:55:56.346894 [debug] [ThreadPool]: Using postgres connection "list_master"
17:55:56.347219 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
17:55:56.349969 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:56.409518 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
17:55:56.411555 [debug] [ThreadPool]: On list_master: Close
17:55:56.412850 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
17:55:56.434795 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:55:56.435073 [debug] [ThreadPool]: On list_master_public: BEGIN
17:55:56.435182 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:56.446549 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:55:56.446783 [debug] [ThreadPool]: Using postgres connection "list_master_public"
17:55:56.446882 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:55:56.449838 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
17:55:56.451845 [debug] [ThreadPool]: On list_master_public: ROLLBACK
17:55:56.452434 [debug] [ThreadPool]: On list_master_public: Close
17:55:56.472639 [debug] [MainThread]: Using postgres connection "master"
17:55:56.473565 [debug] [MainThread]: On master: BEGIN
17:55:56.473840 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:56.540164 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
17:55:56.540573 [debug] [MainThread]: Using postgres connection "master"
17:55:56.540739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:56.545252 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
17:55:56.546448 [debug] [MainThread]: On master: ROLLBACK
17:55:56.546834 [debug] [MainThread]: Using postgres connection "master"
17:55:56.546985 [debug] [MainThread]: On master: BEGIN
17:55:56.547402 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:55:56.547871 [debug] [MainThread]: On master: COMMIT
17:55:56.548540 [debug] [MainThread]: Using postgres connection "master"
17:55:56.548684 [debug] [MainThread]: On master: COMMIT
17:55:56.549018 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:56.549198 [debug] [MainThread]: On master: Close
17:55:56.549546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:55:56.551994 [info ] [MainThread]: 
17:55:56.601255 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
17:55:56.601883 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
17:55:56.602383 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.602773 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
17:55:56.602893 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
17:55:56.629259 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
17:55:56.630040 [debug] [Thread-1  ]: finished collecting timing info
17:55:56.630198 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
17:55:56.656573 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
17:55:56.657571 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.658340 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
17:55:56.658735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:56.685617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:55:56.685914 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.686030 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:55:56.697988 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:55:56.716224 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.716511 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:55:56.717151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:56.720350 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.731667 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:55:56.732365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:56.771510 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:55:56.772028 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.772586 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
17:55:56.779054 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:55:56.783083 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
17:55:56.792649 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
17:55:56.815372 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:55:56.816652 [debug] [Thread-1  ]: finished collecting timing info
17:55:56.817004 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
17:55:56.817894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bff5f19b-b187-4d74-a038-81974e247990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65edb95a60>]}
17:55:56.818332 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.22s]
17:55:56.818676 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
17:55:56.824073 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
17:55:56.824583 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
17:55:56.826085 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
17:55:56.826509 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
17:55:56.826695 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
17:55:56.830256 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
17:55:56.830830 [debug] [Thread-1  ]: finished collecting timing info
17:55:56.830983 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
17:55:56.885924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
17:55:56.886838 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:55:56.903707 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
17:55:56.903844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:56.916685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:55:56.917119 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:55:56.917305 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
17:55:56.918941 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:56.922762 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:55:56.923414 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:55:56.924591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:56.927302 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:55:56.927822 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:55:56.928015 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
17:55:56.940106 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:55:56.942481 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
17:55:56.943025 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
17:55:56.943694 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:56.944980 [debug] [Thread-1  ]: finished collecting timing info
17:55:56.945355 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
17:55:56.948385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bff5f19b-b187-4d74-a038-81974e247990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f10feeb0>]}
17:55:56.949032 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.12s]
17:55:56.949571 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
17:55:56.962796 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:56.963099 [debug] [MainThread]: Using postgres connection "master"
17:55:56.963203 [debug] [MainThread]: On master: BEGIN
17:55:56.963286 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:57.004315 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
17:55:57.004750 [debug] [MainThread]: On master: COMMIT
17:55:57.004915 [debug] [MainThread]: Using postgres connection "master"
17:55:57.005062 [debug] [MainThread]: On master: COMMIT
17:55:57.007912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:57.008313 [debug] [MainThread]: On master: Close
17:55:57.009731 [info ] [MainThread]: 
17:55:57.011279 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.68s.
17:55:57.019326 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:57.020228 [debug] [MainThread]: Connection 'list_master' was properly closed.
17:55:57.020392 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
17:55:57.042061 [info ] [MainThread]: 
17:55:57.043759 [info ] [MainThread]: [32mCompleted successfully[0m
17:55:57.046662 [info ] [MainThread]: 
17:55:57.047474 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:55:57.048076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eebd6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65eebd68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65edb6e2b0>]}


============================== 2022-01-06 18:00:44.032460 | 76598601-427b-415c-88e2-cc0694ba0f75 ==============================
18:00:44.032460 [info ] [MainThread]: Running with dbt=1.0.0
18:00:44.064483 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:00:44.065326 [debug] [MainThread]: Tracking: tracking
18:00:44.274014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ee75790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ee756a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ee75700>]}
18:00:44.459364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:00:44.459862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:00:44.541913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76598601-427b-415c-88e2-cc0694ba0f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ee9f130>]}
18:00:44.556421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76598601-427b-415c-88e2-cc0694ba0f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ee41940>]}
18:00:44.557656 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:00:44.560033 [info ] [MainThread]: 
18:00:44.562036 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:44.563016 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:00:44.572014 [debug] [ThreadPool]: Using postgres connection "list_master"
18:00:44.572336 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:00:44.572969 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:45.127141 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.55 seconds
18:00:45.128685 [debug] [ThreadPool]: On list_master: Close
18:00:45.132558 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:00:45.138740 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:00:45.139333 [debug] [ThreadPool]: On list_master_public: BEGIN
18:00:45.139768 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:45.172771 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:00:45.174295 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:00:45.174782 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:45.284399 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.11 seconds
18:00:45.285591 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:00:45.286411 [debug] [ThreadPool]: On list_master_public: Close
18:00:45.291965 [debug] [MainThread]: Using postgres connection "master"
18:00:45.292401 [debug] [MainThread]: On master: BEGIN
18:00:45.292562 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:45.304521 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:45.305023 [debug] [MainThread]: Using postgres connection "master"
18:00:45.310551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:45.378907 [debug] [MainThread]: SQL status: SELECT 1 in 0.07 seconds
18:00:45.380335 [debug] [MainThread]: On master: ROLLBACK
18:00:45.381481 [debug] [MainThread]: Using postgres connection "master"
18:00:45.381731 [debug] [MainThread]: On master: BEGIN
18:00:45.382211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:45.383491 [debug] [MainThread]: On master: COMMIT
18:00:45.383652 [debug] [MainThread]: Using postgres connection "master"
18:00:45.383851 [debug] [MainThread]: On master: COMMIT
18:00:45.384157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:45.384489 [debug] [MainThread]: On master: Close
18:00:45.384902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:00:45.387722 [info ] [MainThread]: 
18:00:45.461952 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:00:45.462384 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:00:45.463751 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.468535 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:00:45.468824 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:00:45.471215 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:00:45.472655 [debug] [Thread-1  ]: finished collecting timing info
18:00:45.473227 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:00:45.510145 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:00:45.512215 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.512646 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:00:45.512839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:45.529967 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:00:45.541674 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.542006 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:00:45.614148 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.07 seconds
18:00:45.619018 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.619277 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:00:45.631079 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:00:45.633674 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.633843 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:00:45.634599 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:45.644797 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:00:45.645060 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.645199 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:00:45.660386 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:00:45.664760 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:00:45.665686 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:00:45.720670 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
18:00:45.723836 [debug] [Thread-1  ]: finished collecting timing info
18:00:45.724785 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:00:45.725839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76598601-427b-415c-88e2-cc0694ba0f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33dcff160>]}
18:00:45.726586 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.26s]
18:00:45.727754 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:00:45.729129 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:00:45.729446 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:00:45.730135 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:00:45.730647 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:00:45.730838 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:00:45.733520 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:00:45.734594 [debug] [Thread-1  ]: finished collecting timing info
18:00:45.734890 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:00:45.750887 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:00:45.751654 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:00:45.751998 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:00:45.752158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:45.761618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:00:45.762032 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:00:45.762256 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:00:45.781791 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
18:00:45.784000 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:00:45.784248 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:00:45.785771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:45.786859 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:00:45.787027 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:00:45.787148 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:00:45.789974 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:00:45.792484 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:00:45.792884 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:00:45.793832 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:00:45.795147 [debug] [Thread-1  ]: finished collecting timing info
18:00:45.795437 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:00:45.807463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76598601-427b-415c-88e2-cc0694ba0f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33eea2580>]}
18:00:45.808421 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.07s]
18:00:45.809093 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:00:45.812964 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:45.813246 [debug] [MainThread]: Using postgres connection "master"
18:00:45.813383 [debug] [MainThread]: On master: BEGIN
18:00:45.813493 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:45.820666 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:45.820942 [debug] [MainThread]: On master: COMMIT
18:00:45.822087 [debug] [MainThread]: Using postgres connection "master"
18:00:45.822262 [debug] [MainThread]: On master: COMMIT
18:00:45.823585 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:45.832377 [debug] [MainThread]: On master: Close
18:00:45.836593 [info ] [MainThread]: 
18:00:45.837008 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.28s.
18:00:45.838251 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:45.838858 [debug] [MainThread]: Connection 'list_master' was properly closed.
18:00:45.839231 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:00:45.850303 [info ] [MainThread]: 
18:00:45.850908 [info ] [MainThread]: [32mCompleted successfully[0m
18:00:45.851277 [info ] [MainThread]: 
18:00:45.851543 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:00:45.852391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ee41580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ed5dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33dd27c70>]}


============================== 2022-01-06 18:13:18.689467 | e90fd161-b647-42db-b107-a008b178f88a ==============================
18:13:18.689467 [info ] [MainThread]: Running with dbt=1.0.0
18:13:18.690338 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:13:18.690591 [debug] [MainThread]: Tracking: tracking
18:13:18.712259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b41940670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b41940f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b41940fd0>]}
18:13:18.771527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:13:18.772240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:13:18.822936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e90fd161-b647-42db-b107-a008b178f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b41975070>]}
18:13:18.836369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e90fd161-b647-42db-b107-a008b178f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b41923940>]}
18:13:18.837037 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:13:18.843692 [info ] [MainThread]: 
18:13:18.850398 [debug] [MainThread]: Acquiring new postgres connection "master"
18:13:18.853930 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:13:18.872716 [debug] [ThreadPool]: Using postgres connection "list_master"
18:13:18.872945 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:13:18.873048 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:13:18.907727 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'could not translate host name "postgres" to address: Temporary failure in name resolution
'
18:13:18.907983 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:13:18.908079 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
18:13:18.908234 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
18:13:18.908332 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
18:13:18.908440 [debug] [ThreadPool]: On list_master: No close available on handle
18:13:18.908885 [debug] [MainThread]: Connection 'master' was properly closed.
18:13:18.908986 [debug] [MainThread]: Connection 'list_master' was properly closed.
18:13:18.910004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b418e5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b418e5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b418e5a30>]}


============================== 2022-01-06 18:15:29.823921 | 923ffe7c-52bb-4de4-92a7-5b7505f31925 ==============================
18:15:29.823921 [info ] [MainThread]: Running with dbt=1.0.0
18:15:29.834868 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:15:29.836182 [debug] [MainThread]: Tracking: tracking
18:15:29.883279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34917f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34917f1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34917f1700>]}
18:15:29.972851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:15:29.973552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:15:30.040522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '923ffe7c-52bb-4de4-92a7-5b7505f31925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3491826160>]}
18:15:30.066115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '923ffe7c-52bb-4de4-92a7-5b7505f31925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34917cd9d0>]}
18:15:30.067235 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:15:30.083792 [info ] [MainThread]: 
18:15:30.091704 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:30.094255 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:15:30.122687 [debug] [ThreadPool]: Using postgres connection "list_master"
18:15:30.124282 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:15:30.124566 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:30.162600 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
18:15:30.167898 [debug] [ThreadPool]: On list_master: Close
18:15:30.172611 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:15:30.178425 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:15:30.180431 [debug] [ThreadPool]: On list_master_public: BEGIN
18:15:30.182631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:15:30.207974 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:15:30.208687 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:15:30.212069 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:15:30.216811 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:15:30.218843 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:15:30.219494 [debug] [ThreadPool]: On list_master_public: Close
18:15:30.229585 [debug] [MainThread]: Using postgres connection "master"
18:15:30.230165 [debug] [MainThread]: On master: BEGIN
18:15:30.230637 [debug] [MainThread]: Opening a new connection, currently in state init
18:15:30.252044 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:15:30.255170 [debug] [MainThread]: Using postgres connection "master"
18:15:30.256001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:15:30.269460 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:15:30.274013 [debug] [MainThread]: On master: ROLLBACK
18:15:30.274485 [debug] [MainThread]: Using postgres connection "master"
18:15:30.275252 [debug] [MainThread]: On master: BEGIN
18:15:30.276300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:30.276696 [debug] [MainThread]: On master: COMMIT
18:15:30.279118 [debug] [MainThread]: Using postgres connection "master"
18:15:30.279596 [debug] [MainThread]: On master: COMMIT
18:15:30.280224 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:30.281952 [debug] [MainThread]: On master: Close
18:15:30.286344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:15:30.286826 [info ] [MainThread]: 
18:15:30.325747 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:15:30.326289 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:15:30.330940 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.331383 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:15:30.331774 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:15:30.335088 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:15:30.337159 [debug] [Thread-1  ]: finished collecting timing info
18:15:30.337879 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:15:30.393192 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:15:30.395210 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.395583 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:15:30.395977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:30.410568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:15:30.410857 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.411037 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:15:30.415675 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:15:30.428004 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.428750 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:15:30.430899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:30.463722 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.467052 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:15:30.467939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:30.478514 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:15:30.479798 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.480510 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:15:30.499997 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:15:30.505491 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:15:30.505927 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:15:30.511776 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:15:30.515357 [debug] [Thread-1  ]: finished collecting timing info
18:15:30.515860 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:15:30.518343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923ffe7c-52bb-4de4-92a7-5b7505f31925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3490e861c0>]}
18:15:30.519084 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.19s]
18:15:30.520765 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:15:30.521571 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:15:30.522700 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:15:30.527520 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:15:30.535488 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:15:30.535894 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:15:30.541166 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:15:30.543517 [debug] [Thread-1  ]: finished collecting timing info
18:15:30.544107 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:15:30.596635 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:15:30.598114 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:15:30.599991 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:15:30.600448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:30.616685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:15:30.617528 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:15:30.617897 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:15:30.620047 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:30.622749 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:15:30.623735 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:15:30.624876 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:30.636057 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:15:30.636590 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:15:30.636933 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:15:30.640091 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:15:30.641959 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:15:30.643170 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:15:30.651505 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:30.656613 [debug] [Thread-1  ]: finished collecting timing info
18:15:30.657141 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:15:30.659598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923ffe7c-52bb-4de4-92a7-5b7505f31925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3490e7fb20>]}
18:15:30.660382 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.14s]
18:15:30.667363 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:15:30.670193 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:30.670931 [debug] [MainThread]: Using postgres connection "master"
18:15:30.671188 [debug] [MainThread]: On master: BEGIN
18:15:30.671387 [debug] [MainThread]: Opening a new connection, currently in state closed
18:15:30.697751 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
18:15:30.698232 [debug] [MainThread]: On master: COMMIT
18:15:30.698690 [debug] [MainThread]: Using postgres connection "master"
18:15:30.699250 [debug] [MainThread]: On master: COMMIT
18:15:30.700433 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:30.700801 [debug] [MainThread]: On master: Close
18:15:30.702358 [info ] [MainThread]: 
18:15:30.703085 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.62s.
18:15:30.704270 [debug] [MainThread]: Connection 'master' was properly closed.
18:15:30.705043 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:15:30.727375 [info ] [MainThread]: 
18:15:30.727897 [info ] [MainThread]: [32mCompleted successfully[0m
18:15:30.730377 [info ] [MainThread]: 
18:15:30.732150 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:15:30.739255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34916ef4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34916ef460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3490eb0c70>]}


============================== 2022-01-06 18:17:48.124426 | 29003724-34cc-4acc-b5f3-fa98f53b1fab ==============================
18:17:48.124426 [info ] [MainThread]: Running with dbt=1.0.0
18:17:48.151075 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:17:48.151392 [debug] [MainThread]: Tracking: tracking
18:17:48.378381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3fc4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3fc46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3fc4700>]}
18:17:48.597711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:17:48.600542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:17:48.679222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29003724-34cc-4acc-b5f3-fa98f53b1fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3fee070>]}
18:17:48.695914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29003724-34cc-4acc-b5f3-fa98f53b1fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3f90940>]}
18:17:48.696426 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:17:48.699560 [info ] [MainThread]: 
18:17:48.700459 [debug] [MainThread]: Acquiring new postgres connection "master"
18:17:48.702463 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:17:48.711265 [debug] [ThreadPool]: Using postgres connection "list_master"
18:17:48.712709 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:17:48.712967 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:17:49.051539 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.34 seconds
18:17:49.052787 [debug] [ThreadPool]: On list_master: Close
18:17:49.054595 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:17:49.059794 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:17:49.060087 [debug] [ThreadPool]: On list_master_public: BEGIN
18:17:49.060286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:17:49.077802 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:17:49.078640 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:17:49.079259 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:17:49.142536 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.06 seconds
18:17:49.143810 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:17:49.144419 [debug] [ThreadPool]: On list_master_public: Close
18:17:49.151375 [debug] [MainThread]: Using postgres connection "master"
18:17:49.151697 [debug] [MainThread]: On master: BEGIN
18:17:49.159046 [debug] [MainThread]: Opening a new connection, currently in state init
18:17:49.170191 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:17:49.173348 [debug] [MainThread]: Using postgres connection "master"
18:17:49.174141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:17:49.212115 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
18:17:49.214200 [debug] [MainThread]: On master: ROLLBACK
18:17:49.215547 [debug] [MainThread]: Using postgres connection "master"
18:17:49.216011 [debug] [MainThread]: On master: BEGIN
18:17:49.229832 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:17:49.230256 [debug] [MainThread]: On master: COMMIT
18:17:49.230515 [debug] [MainThread]: Using postgres connection "master"
18:17:49.230626 [debug] [MainThread]: On master: COMMIT
18:17:49.232815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:17:49.233400 [debug] [MainThread]: On master: Close
18:17:49.236183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:17:49.237992 [info ] [MainThread]: 
18:17:49.330932 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:17:49.331667 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:17:49.333558 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.334251 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:17:49.334658 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:17:49.336853 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:17:49.378009 [debug] [Thread-1  ]: finished collecting timing info
18:17:49.378431 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:17:49.426885 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:17:49.440178 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.440691 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:17:49.440870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:17:49.459596 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:17:49.460019 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.460230 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:17:49.523452 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.06 seconds
18:17:49.530293 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.532130 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:17:49.553903 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
18:17:49.556609 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.556799 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:17:49.557647 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:17:49.572885 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:17:49.573176 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.573306 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:17:49.588290 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:17:49.592568 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:17:49.592814 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:17:49.626474 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
18:17:49.627778 [debug] [Thread-1  ]: finished collecting timing info
18:17:49.627972 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:17:49.628601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29003724-34cc-4acc-b5f3-fa98f53b1fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe364f220>]}
18:17:49.629140 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.30s]
18:17:49.632036 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:17:49.633556 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:17:49.634021 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:17:49.637145 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:17:49.638421 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:17:49.638875 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:17:49.641176 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:17:49.641897 [debug] [Thread-1  ]: finished collecting timing info
18:17:49.642088 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:17:49.662056 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:17:49.663392 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:17:49.664035 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:17:49.664433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:17:49.676481 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:17:49.677704 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:17:49.677864 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:17:49.698171 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
18:17:49.700545 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:17:49.700920 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:17:49.701617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:17:49.702906 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:17:49.703164 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:17:49.703289 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:17:49.714724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:17:49.717904 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:17:49.718210 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:17:49.718713 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:17:49.720725 [debug] [Thread-1  ]: finished collecting timing info
18:17:49.721591 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:17:49.724336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29003724-34cc-4acc-b5f3-fa98f53b1fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3fffc10>]}
18:17:49.724824 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.09s]
18:17:49.725607 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:17:49.728221 [debug] [MainThread]: Acquiring new postgres connection "master"
18:17:49.729722 [debug] [MainThread]: Using postgres connection "master"
18:17:49.730064 [debug] [MainThread]: On master: BEGIN
18:17:49.730298 [debug] [MainThread]: Opening a new connection, currently in state closed
18:17:49.742224 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:17:49.742506 [debug] [MainThread]: On master: COMMIT
18:17:49.742606 [debug] [MainThread]: Using postgres connection "master"
18:17:49.742703 [debug] [MainThread]: On master: COMMIT
18:17:49.742903 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:17:49.743021 [debug] [MainThread]: On master: Close
18:17:49.743393 [info ] [MainThread]: 
18:17:49.747081 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.04s.
18:17:49.748583 [debug] [MainThread]: Connection 'master' was properly closed.
18:17:49.758404 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:17:49.763345 [info ] [MainThread]: 
18:17:49.764210 [info ] [MainThread]: [32mCompleted successfully[0m
18:17:49.768321 [info ] [MainThread]: 
18:17:49.768915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:17:49.769386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe585a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3651ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3651790>]}


============================== 2022-01-06 18:26:23.071828 | 183d81cc-2c0a-4478-b55a-0e3491749148 ==============================
18:26:23.071828 [info ] [MainThread]: Running with dbt=1.0.0
18:26:23.087696 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:26:23.088053 [debug] [MainThread]: Tracking: tracking
18:26:23.255488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064fae400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064fae6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064fae550>]}
18:26:23.383103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:26:23.383921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:26:23.467016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183d81cc-2c0a-4478-b55a-0e3491749148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064f86100>]}
18:26:23.479093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183d81cc-2c0a-4478-b55a-0e3491749148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064f2f9d0>]}
18:26:23.479601 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:26:23.482197 [info ] [MainThread]: 
18:26:23.484999 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:23.486616 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:26:23.504310 [debug] [ThreadPool]: Using postgres connection "list_master"
18:26:23.505014 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:26:23.505431 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:23.865228 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.36 seconds
18:26:23.867692 [debug] [ThreadPool]: On list_master: Close
18:26:23.869708 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:26:23.875859 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:26:23.876179 [debug] [ThreadPool]: On list_master_public: BEGIN
18:26:23.876440 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:23.896724 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:26:23.897119 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:26:23.897736 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:24.003814 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.11 seconds
18:26:24.005297 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:26:24.005706 [debug] [ThreadPool]: On list_master_public: Close
18:26:24.012659 [debug] [MainThread]: Using postgres connection "master"
18:26:24.013564 [debug] [MainThread]: On master: BEGIN
18:26:24.014208 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:24.024932 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:24.025411 [debug] [MainThread]: Using postgres connection "master"
18:26:24.025738 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:24.111820 [debug] [MainThread]: SQL status: SELECT 1 in 0.09 seconds
18:26:24.113505 [debug] [MainThread]: On master: ROLLBACK
18:26:24.114229 [debug] [MainThread]: Using postgres connection "master"
18:26:24.114477 [debug] [MainThread]: On master: BEGIN
18:26:24.118819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:24.119517 [debug] [MainThread]: On master: COMMIT
18:26:24.119814 [debug] [MainThread]: Using postgres connection "master"
18:26:24.120112 [debug] [MainThread]: On master: COMMIT
18:26:24.120978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:24.121360 [debug] [MainThread]: On master: Close
18:26:24.122143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:26:24.122639 [info ] [MainThread]: 
18:26:24.177944 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:26:24.178262 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:26:24.184617 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.185140 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:26:24.185382 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:26:24.188229 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:26:24.199271 [debug] [Thread-1  ]: finished collecting timing info
18:26:24.199883 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:26:24.245690 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:26:24.246253 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.246401 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:26:24.246491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:24.260648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:26:24.261483 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.261623 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:26:24.307334 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.05 seconds
18:26:24.315283 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.316165 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:26:24.323146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:24.325953 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.333588 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:26:24.335764 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:24.349020 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:26:24.349595 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.349905 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:26:24.385812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
18:26:24.390953 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:26:24.391424 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:26:24.419827 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
18:26:24.421405 [debug] [Thread-1  ]: finished collecting timing info
18:26:24.421921 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:26:24.422573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183d81cc-2c0a-4478-b55a-0e3491749148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00645e51c0>]}
18:26:24.422955 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.24s]
18:26:24.423362 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:26:24.432023 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:26:24.433045 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:26:24.434718 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:26:24.435304 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:26:24.435527 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:26:24.437942 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:26:24.440744 [debug] [Thread-1  ]: finished collecting timing info
18:26:24.441130 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:26:24.468603 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:26:24.469795 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:26:24.470376 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:26:24.470500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:24.493874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:26:24.494353 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:26:24.494468 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:26:24.506258 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:24.508385 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:26:24.508613 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:26:24.509175 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:24.510214 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:26:24.510391 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:26:24.510514 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:26:24.512658 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:26:24.514528 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:26:24.516113 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:26:24.523405 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:24.525263 [debug] [Thread-1  ]: finished collecting timing info
18:26:24.525819 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:26:24.526778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183d81cc-2c0a-4478-b55a-0e3491749148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064f978b0>]}
18:26:24.527421 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.09s]
18:26:24.528332 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:26:24.538595 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:24.538869 [debug] [MainThread]: Using postgres connection "master"
18:26:24.539100 [debug] [MainThread]: On master: BEGIN
18:26:24.539237 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:24.570585 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
18:26:24.570842 [debug] [MainThread]: On master: COMMIT
18:26:24.570948 [debug] [MainThread]: Using postgres connection "master"
18:26:24.571035 [debug] [MainThread]: On master: COMMIT
18:26:24.571330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:24.571486 [debug] [MainThread]: On master: Close
18:26:24.580576 [info ] [MainThread]: 
18:26:24.582386 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.10s.
18:26:24.585987 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:24.586565 [debug] [MainThread]: Connection 'list_master' was properly closed.
18:26:24.586753 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:26:24.591446 [info ] [MainThread]: 
18:26:24.591879 [info ] [MainThread]: [32mCompleted successfully[0m
18:26:24.592792 [info ] [MainThread]: 
18:26:24.593442 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:26:24.595029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064e4f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064e4f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0064610700>]}


============================== 2022-01-06 18:37:21.062551 | 99ec6bed-241c-47cd-9fe5-7bd3efa77651 ==============================
18:37:21.062551 [info ] [MainThread]: Running with dbt=1.0.0
18:37:21.117144 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:37:21.117728 [debug] [MainThread]: Tracking: tracking
18:37:21.342798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b8147670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b8147fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b8147700>]}
18:37:21.578613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:37:21.579061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:37:21.662698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99ec6bed-241c-47cd-9fe5-7bd3efa77651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b8179100>]}
18:37:21.678199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99ec6bed-241c-47cd-9fe5-7bd3efa77651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b81249d0>]}
18:37:21.678989 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:37:21.680547 [info ] [MainThread]: 
18:37:21.681416 [debug] [MainThread]: Acquiring new postgres connection "master"
18:37:21.682414 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:37:21.692567 [debug] [ThreadPool]: Using postgres connection "list_master"
18:37:21.693024 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:37:21.693828 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:37:22.115565 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.42 seconds
18:37:22.117012 [debug] [ThreadPool]: On list_master: Close
18:37:22.118773 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:37:22.126296 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:37:22.126786 [debug] [ThreadPool]: On list_master_public: BEGIN
18:37:22.126991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:37:22.144792 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:37:22.146303 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:37:22.146580 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:37:22.245763 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.1 seconds
18:37:22.246977 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:37:22.247561 [debug] [ThreadPool]: On list_master_public: Close
18:37:22.263868 [debug] [MainThread]: Using postgres connection "master"
18:37:22.264154 [debug] [MainThread]: On master: BEGIN
18:37:22.264529 [debug] [MainThread]: Opening a new connection, currently in state init
18:37:22.275674 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:37:22.276373 [debug] [MainThread]: Using postgres connection "master"
18:37:22.276630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:37:22.336385 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
18:37:22.337738 [debug] [MainThread]: On master: ROLLBACK
18:37:22.358063 [debug] [MainThread]: Using postgres connection "master"
18:37:22.358407 [debug] [MainThread]: On master: BEGIN
18:37:22.360500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:37:22.360824 [debug] [MainThread]: On master: COMMIT
18:37:22.361019 [debug] [MainThread]: Using postgres connection "master"
18:37:22.361148 [debug] [MainThread]: On master: COMMIT
18:37:22.362010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:37:22.362339 [debug] [MainThread]: On master: Close
18:37:22.363022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:37:22.363563 [info ] [MainThread]: 
18:37:22.412314 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:37:22.412764 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:37:22.414829 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.415169 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:37:22.415373 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:37:22.418813 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:37:22.419944 [debug] [Thread-1  ]: finished collecting timing info
18:37:22.420641 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:37:22.482257 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:37:22.486711 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.487312 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:37:22.487507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:37:22.497868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:37:22.498160 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.498316 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:37:22.568780 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.07 seconds
18:37:22.575553 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.575818 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:37:22.584337 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:37:22.587451 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.587717 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:37:22.589572 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:37:22.603715 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:37:22.604019 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.604166 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:37:22.614983 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:37:22.621427 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:37:22.622021 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:37:22.676035 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
18:37:22.677577 [debug] [Thread-1  ]: finished collecting timing info
18:37:22.677858 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:37:22.678296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec6bed-241c-47cd-9fe5-7bd3efa77651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b7806a60>]}
18:37:22.679828 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.26s]
18:37:22.683528 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:37:22.685521 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:37:22.685868 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:37:22.686819 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:37:22.687012 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:37:22.687240 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:37:22.690400 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:37:22.691866 [debug] [Thread-1  ]: finished collecting timing info
18:37:22.692368 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:37:22.720634 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:37:22.721763 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:37:22.722057 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:37:22.722216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:37:22.749053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:37:22.749280 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:37:22.749392 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:37:22.767055 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
18:37:22.769243 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:37:22.769757 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:37:22.770306 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:37:22.771465 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:37:22.772203 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:37:22.772430 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:37:22.778255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:37:22.780985 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:37:22.781377 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:37:22.784899 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:37:22.786457 [debug] [Thread-1  ]: finished collecting timing info
18:37:22.787011 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:37:22.796819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec6bed-241c-47cd-9fe5-7bd3efa77651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b818eeb0>]}
18:37:22.797328 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.11s]
18:37:22.799381 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:37:22.802381 [debug] [MainThread]: Acquiring new postgres connection "master"
18:37:22.802819 [debug] [MainThread]: Using postgres connection "master"
18:37:22.802964 [debug] [MainThread]: On master: BEGIN
18:37:22.803059 [debug] [MainThread]: Opening a new connection, currently in state closed
18:37:22.812280 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:37:22.813444 [debug] [MainThread]: On master: COMMIT
18:37:22.813947 [debug] [MainThread]: Using postgres connection "master"
18:37:22.814137 [debug] [MainThread]: On master: COMMIT
18:37:22.814463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:37:22.814686 [debug] [MainThread]: On master: Close
18:37:22.816764 [info ] [MainThread]: 
18:37:22.817579 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.14s.
18:37:22.818454 [debug] [MainThread]: Connection 'master' was properly closed.
18:37:22.818784 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:37:22.825654 [info ] [MainThread]: 
18:37:22.826886 [info ] [MainThread]: [32mCompleted successfully[0m
18:37:22.850325 [info ] [MainThread]: 
18:37:22.851089 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:37:22.851454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b77e0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b77e0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b77e04f0>]}


============================== 2022-01-06 18:43:52.841341 | 5c291528-a3ef-4d16-a48e-fbea5f296c6d ==============================
18:43:52.841341 [info ] [MainThread]: Running with dbt=1.0.0
18:43:52.843395 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:43:52.843779 [debug] [MainThread]: Tracking: tracking
18:43:52.854776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac310a7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac310a76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac310a7580>]}
18:43:52.926363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:43:52.947269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:43:52.994666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c291528-a3ef-4d16-a48e-fbea5f296c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3107d160>]}
18:43:53.001229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c291528-a3ef-4d16-a48e-fbea5f296c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31023b80>]}
18:43:53.002043 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:43:53.005293 [info ] [MainThread]: 
18:43:53.006995 [debug] [MainThread]: Acquiring new postgres connection "master"
18:43:53.008132 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:43:53.033632 [debug] [ThreadPool]: Using postgres connection "list_master"
18:43:53.034562 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:43:53.047391 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:43:53.088081 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
18:43:53.090693 [debug] [ThreadPool]: On list_master: Close
18:43:53.102154 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:43:53.109399 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:43:53.109675 [debug] [ThreadPool]: On list_master_public: BEGIN
18:43:53.109806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:43:53.117925 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:43:53.120964 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:43:53.121738 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:43:53.124884 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:43:53.126157 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:43:53.126516 [debug] [ThreadPool]: On list_master_public: Close
18:43:53.132058 [debug] [MainThread]: Using postgres connection "master"
18:43:53.132340 [debug] [MainThread]: On master: BEGIN
18:43:53.132478 [debug] [MainThread]: Opening a new connection, currently in state init
18:43:53.142269 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:43:53.142606 [debug] [MainThread]: Using postgres connection "master"
18:43:53.142763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:43:53.146196 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
18:43:53.147585 [debug] [MainThread]: On master: ROLLBACK
18:43:53.148010 [debug] [MainThread]: Using postgres connection "master"
18:43:53.148170 [debug] [MainThread]: On master: BEGIN
18:43:53.148588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:43:53.148742 [debug] [MainThread]: On master: COMMIT
18:43:53.149673 [debug] [MainThread]: Using postgres connection "master"
18:43:53.149831 [debug] [MainThread]: On master: COMMIT
18:43:53.150096 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:43:53.150254 [debug] [MainThread]: On master: Close
18:43:53.154613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:43:53.155250 [info ] [MainThread]: 
18:43:53.172733 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:43:53.173183 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:43:53.175801 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.176167 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:43:53.176403 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:43:53.178547 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:43:53.179409 [debug] [Thread-1  ]: finished collecting timing info
18:43:53.179838 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:43:53.205304 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:43:53.210498 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.210763 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:43:53.210910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:43:53.259879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
18:43:53.260317 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.260422 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:43:53.262527 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:43:53.267930 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.268298 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:43:53.269987 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:43:53.274403 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.274613 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:43:53.284199 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:43:53.306524 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:43:53.306863 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.307004 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:43:53.315690 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:43:53.323416 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:43:53.323668 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:43:53.332969 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:43:53.334284 [debug] [Thread-1  ]: finished collecting timing info
18:43:53.334567 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:43:53.336133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c291528-a3ef-4d16-a48e-fbea5f296c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac306dc1c0>]}
18:43:53.337003 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.16s]
18:43:53.338612 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:43:53.339396 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:43:53.339680 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:43:53.340247 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:43:53.348368 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:43:53.348560 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:43:53.351207 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:43:53.353238 [debug] [Thread-1  ]: finished collecting timing info
18:43:53.353557 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:43:53.372718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:43:53.402666 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:43:53.403340 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:43:53.403784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:43:53.419120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:43:53.419789 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:43:53.420040 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:43:53.421706 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:43:53.424943 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:43:53.425389 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:43:53.426151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:43:53.427410 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:43:53.427653 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:43:53.427800 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:43:53.432970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:43:53.435193 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:43:53.435635 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:43:53.436183 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:43:53.437824 [debug] [Thread-1  ]: finished collecting timing info
18:43:53.438625 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:43:53.441467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c291528-a3ef-4d16-a48e-fbea5f296c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac31092550>]}
18:43:53.441946 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.10s]
18:43:53.442402 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:43:53.443899 [debug] [MainThread]: Acquiring new postgres connection "master"
18:43:53.444167 [debug] [MainThread]: Using postgres connection "master"
18:43:53.444338 [debug] [MainThread]: On master: BEGIN
18:43:53.444454 [debug] [MainThread]: Opening a new connection, currently in state closed
18:43:53.452882 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:43:53.453687 [debug] [MainThread]: On master: COMMIT
18:43:53.453906 [debug] [MainThread]: Using postgres connection "master"
18:43:53.454112 [debug] [MainThread]: On master: COMMIT
18:43:53.454449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:43:53.454665 [debug] [MainThread]: On master: Close
18:43:53.457485 [info ] [MainThread]: 
18:43:53.458710 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.45s.
18:43:53.459743 [debug] [MainThread]: Connection 'master' was properly closed.
18:43:53.460632 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:43:53.465682 [info ] [MainThread]: 
18:43:53.466218 [info ] [MainThread]: [32mCompleted successfully[0m
18:43:53.467148 [info ] [MainThread]: 
18:43:53.468180 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:43:53.469890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac30f46bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac30f46b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac307094f0>]}


============================== 2022-01-06 18:46:20.998455 | 489c96cf-e0da-44d0-bbac-3d51791b558d ==============================
18:46:20.998455 [info ] [MainThread]: Running with dbt=1.0.0
18:46:21.000008 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:46:21.000966 [debug] [MainThread]: Tracking: tracking
18:46:21.031877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d56d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d56d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d56d580>]}
18:46:21.101650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:46:21.106621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:46:21.153194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '489c96cf-e0da-44d0-bbac-3d51791b558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d546160>]}
18:46:21.162014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '489c96cf-e0da-44d0-bbac-3d51791b558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d4ecb80>]}
18:46:21.162381 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:46:21.164285 [info ] [MainThread]: 
18:46:21.165705 [debug] [MainThread]: Acquiring new postgres connection "master"
18:46:21.166620 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:46:21.177093 [debug] [ThreadPool]: Using postgres connection "list_master"
18:46:21.177379 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:46:21.177532 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:46:21.191455 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:46:21.193106 [debug] [ThreadPool]: On list_master: Close
18:46:21.210519 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:46:21.230736 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:46:21.230950 [debug] [ThreadPool]: On list_master_public: BEGIN
18:46:21.231049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:46:21.257426 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:46:21.257743 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:46:21.257909 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:46:21.260674 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:46:21.262242 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:46:21.262779 [debug] [ThreadPool]: On list_master_public: Close
18:46:21.269847 [debug] [MainThread]: Using postgres connection "master"
18:46:21.270107 [debug] [MainThread]: On master: BEGIN
18:46:21.270244 [debug] [MainThread]: Opening a new connection, currently in state init
18:46:21.280834 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:46:21.281100 [debug] [MainThread]: Using postgres connection "master"
18:46:21.281262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:46:21.284452 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
18:46:21.285629 [debug] [MainThread]: On master: ROLLBACK
18:46:21.285948 [debug] [MainThread]: Using postgres connection "master"
18:46:21.286105 [debug] [MainThread]: On master: BEGIN
18:46:21.287539 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:46:21.287902 [debug] [MainThread]: On master: COMMIT
18:46:21.288332 [debug] [MainThread]: Using postgres connection "master"
18:46:21.288602 [debug] [MainThread]: On master: COMMIT
18:46:21.289118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:46:21.290132 [debug] [MainThread]: On master: Close
18:46:21.294264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:46:21.298083 [info ] [MainThread]: 
18:46:21.315611 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:46:21.315957 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:46:21.317317 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.317594 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:46:21.317757 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:46:21.320043 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:46:21.321267 [debug] [Thread-1  ]: finished collecting timing info
18:46:21.321900 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:46:21.365793 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:46:21.366677 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.367027 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:46:21.367169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:21.432630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.07 seconds
18:46:21.435097 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.435366 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:46:21.442699 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:46:21.450925 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.458633 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:46:21.460036 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:46:21.465033 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.469095 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:46:21.484450 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:46:21.503820 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:46:21.504634 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.504842 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:46:21.521179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:46:21.527738 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:46:21.528020 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:46:21.531191 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:46:21.532492 [debug] [Thread-1  ]: finished collecting timing info
18:46:21.532776 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:46:21.535335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489c96cf-e0da-44d0-bbac-3d51791b558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369cba71c0>]}
18:46:21.535837 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.22s]
18:46:21.541350 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:46:21.543686 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:46:21.544110 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:46:21.545304 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:46:21.546184 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:46:21.546344 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:46:21.548455 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:46:21.549449 [debug] [Thread-1  ]: finished collecting timing info
18:46:21.549626 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:46:21.564931 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:46:21.567591 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:46:21.567846 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:46:21.567972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:46:21.594504 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:46:21.594902 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:46:21.595069 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:46:21.599743 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:46:21.601805 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:46:21.602002 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:46:21.611641 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:46:21.612818 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:46:21.613008 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:46:21.613106 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:46:21.622825 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:46:21.625027 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:46:21.625352 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:46:21.627472 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:46:21.628564 [debug] [Thread-1  ]: finished collecting timing info
18:46:21.628726 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:46:21.629767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489c96cf-e0da-44d0-bbac-3d51791b558d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d556130>]}
18:46:21.630109 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.09s]
18:46:21.630440 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:46:21.645627 [debug] [MainThread]: Acquiring new postgres connection "master"
18:46:21.645906 [debug] [MainThread]: Using postgres connection "master"
18:46:21.646020 [debug] [MainThread]: On master: BEGIN
18:46:21.646166 [debug] [MainThread]: Opening a new connection, currently in state closed
18:46:21.672366 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
18:46:21.673210 [debug] [MainThread]: On master: COMMIT
18:46:21.673447 [debug] [MainThread]: Using postgres connection "master"
18:46:21.673600 [debug] [MainThread]: On master: COMMIT
18:46:21.686835 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
18:46:21.687089 [debug] [MainThread]: On master: Close
18:46:21.687827 [info ] [MainThread]: 
18:46:21.688291 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.52s.
18:46:21.690130 [debug] [MainThread]: Connection 'master' was properly closed.
18:46:21.691102 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:46:21.709155 [info ] [MainThread]: 
18:46:21.709747 [info ] [MainThread]: [32mCompleted successfully[0m
18:46:21.719570 [info ] [MainThread]: 
18:46:21.721035 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:46:21.722363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d403b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369d403bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369cbcf460>]}


============================== 2022-01-06 18:49:23.887133 | deca3426-25a0-4d71-98e6-bd7a67cc3aa4 ==============================
18:49:23.887133 [info ] [MainThread]: Running with dbt=1.0.0
18:49:23.889294 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:49:23.889928 [debug] [MainThread]: Tracking: tracking
18:49:23.909367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc2b1a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc2b1af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc2b1afd0>]}
18:49:24.033631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:49:24.037384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:49:24.117584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deca3426-25a0-4d71-98e6-bd7a67cc3aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc2b4b070>]}
18:49:24.140137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deca3426-25a0-4d71-98e6-bd7a67cc3aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc2af6940>]}
18:49:24.140649 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:49:24.142704 [info ] [MainThread]: 
18:49:24.143740 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:24.146849 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:49:24.156842 [debug] [ThreadPool]: Using postgres connection "list_master"
18:49:24.157204 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:49:24.157358 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:49:24.178740 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
18:49:24.181525 [debug] [ThreadPool]: On list_master: Close
18:49:24.186083 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:49:24.202385 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:49:24.202985 [debug] [ThreadPool]: On list_master_public: BEGIN
18:49:24.211910 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:49:24.246468 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:49:24.253708 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:49:24.253996 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:49:24.260419 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
18:49:24.261821 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:49:24.262282 [debug] [ThreadPool]: On list_master_public: Close
18:49:24.266591 [debug] [MainThread]: Using postgres connection "master"
18:49:24.272574 [debug] [MainThread]: On master: BEGIN
18:49:24.273903 [debug] [MainThread]: Opening a new connection, currently in state init
18:49:24.298704 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:49:24.299125 [debug] [MainThread]: Using postgres connection "master"
18:49:24.299287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:49:24.310530 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:49:24.315626 [debug] [MainThread]: On master: ROLLBACK
18:49:24.316049 [debug] [MainThread]: Using postgres connection "master"
18:49:24.316258 [debug] [MainThread]: On master: BEGIN
18:49:24.316640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:24.316787 [debug] [MainThread]: On master: COMMIT
18:49:24.317294 [debug] [MainThread]: Using postgres connection "master"
18:49:24.317410 [debug] [MainThread]: On master: COMMIT
18:49:24.317619 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:24.317766 [debug] [MainThread]: On master: Close
18:49:24.321149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:49:24.322019 [info ] [MainThread]: 
18:49:24.354501 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:49:24.360615 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:49:24.364131 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.366259 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:49:24.366651 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:49:24.369354 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:49:24.370469 [debug] [Thread-1  ]: finished collecting timing info
18:49:24.370696 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:49:24.414904 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:49:24.416483 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.416906 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:49:24.417049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:24.449644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:49:24.450185 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.450368 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:49:24.455178 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:49:24.467407 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.467738 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:49:24.476458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:49:24.486674 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.487877 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:49:24.491616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:24.515206 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:49:24.515496 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.515611 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:49:24.534045 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:49:24.538247 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:49:24.538443 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:49:24.565231 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
18:49:24.566556 [debug] [Thread-1  ]: finished collecting timing info
18:49:24.566786 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:49:24.567661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deca3426-25a0-4d71-98e6-bd7a67cc3aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc19d5a60>]}
18:49:24.568014 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.20s]
18:49:24.568500 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:49:24.582251 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:49:24.582577 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:49:24.583427 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:49:24.583943 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:49:24.584060 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:49:24.586058 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:49:24.586470 [debug] [Thread-1  ]: finished collecting timing info
18:49:24.593288 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:49:24.612861 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:49:24.620055 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:49:24.620464 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:49:24.620641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:24.655919 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
18:49:24.656206 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:49:24.656318 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:49:24.680095 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
18:49:24.682117 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:49:24.682290 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:49:24.682774 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:24.683692 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:49:24.683812 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:49:24.683897 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:49:24.686964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:24.688389 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:49:24.688548 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:49:24.688885 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:49:24.689905 [debug] [Thread-1  ]: finished collecting timing info
18:49:24.690055 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:49:24.693162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deca3426-25a0-4d71-98e6-bd7a67cc3aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc19aad30>]}
18:49:24.693902 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.11s]
18:49:24.695318 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:49:24.706836 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:24.707081 [debug] [MainThread]: Using postgres connection "master"
18:49:24.707183 [debug] [MainThread]: On master: BEGIN
18:49:24.707264 [debug] [MainThread]: Opening a new connection, currently in state closed
18:49:24.766797 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
18:49:24.767176 [debug] [MainThread]: On master: COMMIT
18:49:24.767344 [debug] [MainThread]: Using postgres connection "master"
18:49:24.767527 [debug] [MainThread]: On master: COMMIT
18:49:24.767896 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:24.768162 [debug] [MainThread]: On master: Close
18:49:24.768785 [info ] [MainThread]: 
18:49:24.778306 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.63s.
18:49:24.779433 [debug] [MainThread]: Connection 'master' was properly closed.
18:49:24.779650 [debug] [MainThread]: Connection 'list_master' was properly closed.
18:49:24.779749 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:49:24.800186 [info ] [MainThread]: 
18:49:24.801651 [info ] [MainThread]: [32mCompleted successfully[0m
18:49:24.803652 [info ] [MainThread]: 
18:49:24.804769 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:49:24.806254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc2af6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc19b2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bc19b27c0>]}


============================== 2022-01-06 18:51:50.274047 | a0386877-1ce7-4da0-a5db-4bf6dba40207 ==============================
18:51:50.274047 [info ] [MainThread]: Running with dbt=1.0.0
18:51:50.293262 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:51:50.296445 [debug] [MainThread]: Tracking: tracking
18:51:50.315236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b029c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b029cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b029c700>]}
18:51:50.377683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:51:50.387713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:51:50.507412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0386877-1ce7-4da0-a5db-4bf6dba40207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b02d1100>]}
18:51:50.516973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0386877-1ce7-4da0-a5db-4bf6dba40207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b027e9d0>]}
18:51:50.517405 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:51:50.550024 [info ] [MainThread]: 
18:51:50.550793 [debug] [MainThread]: Acquiring new postgres connection "master"
18:51:50.552280 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:51:50.602282 [debug] [ThreadPool]: Using postgres connection "list_master"
18:51:50.602831 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:51:50.602967 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:51:50.641255 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
18:51:50.642636 [debug] [ThreadPool]: On list_master: Close
18:51:50.648484 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:51:50.654802 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:51:50.688307 [debug] [ThreadPool]: On list_master_public: BEGIN
18:51:50.688565 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:51:50.706689 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:51:50.707116 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:51:50.707263 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:51:50.710121 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:51:50.711979 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:51:50.721531 [debug] [ThreadPool]: On list_master_public: Close
18:51:50.730137 [debug] [MainThread]: Using postgres connection "master"
18:51:50.731312 [debug] [MainThread]: On master: BEGIN
18:51:50.743220 [debug] [MainThread]: Opening a new connection, currently in state init
18:51:50.783391 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
18:51:50.796643 [debug] [MainThread]: Using postgres connection "master"
18:51:50.796863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:51:50.801076 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
18:51:50.802350 [debug] [MainThread]: On master: ROLLBACK
18:51:50.808007 [debug] [MainThread]: Using postgres connection "master"
18:51:50.808225 [debug] [MainThread]: On master: BEGIN
18:51:50.809640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:51:50.810200 [debug] [MainThread]: On master: COMMIT
18:51:50.810388 [debug] [MainThread]: Using postgres connection "master"
18:51:50.810487 [debug] [MainThread]: On master: COMMIT
18:51:50.810838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:51:50.811161 [debug] [MainThread]: On master: Close
18:51:50.811607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:51:50.817313 [info ] [MainThread]: 
18:51:50.887803 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:51:50.888200 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:51:50.892359 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:50.919785 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:51:50.919944 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:51:50.937346 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:51:50.938745 [debug] [Thread-1  ]: finished collecting timing info
18:51:50.938920 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:51:50.988294 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:51:51.012673 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:51.013019 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:51:51.013210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:51:51.105129 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
18:51:51.106096 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:51.106237 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:51:51.107800 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:51:51.113604 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:51.128690 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:51:51.129779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:51:51.133873 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:51.134216 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:51:51.134687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:51:51.442308 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:51:51.442643 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:51.442807 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:51:51.479595 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
18:51:51.485389 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:51:51.485616 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:51:51.488511 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:51:51.489850 [debug] [Thread-1  ]: finished collecting timing info
18:51:51.490108 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:51:51.496015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0386877-1ce7-4da0-a5db-4bf6dba40207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5af1331c0>]}
18:51:51.498203 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.61s]
18:51:51.508231 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:51:51.509392 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:51:51.509871 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:51:51.510755 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:51:51.510909 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:51:51.511270 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:51:51.514770 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:51:51.519984 [debug] [Thread-1  ]: finished collecting timing info
18:51:51.520772 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:51:51.542492 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:51:51.548729 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:51:51.549022 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:51:51.549153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:51:51.576224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:51:51.576807 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:51:51.577083 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:51:51.581053 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:51:51.585994 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:51:51.586308 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:51:51.586907 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:51:51.588076 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:51:51.588271 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:51:51.588386 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:51:51.595490 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:51:51.598130 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:51:51.598490 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:51:51.599102 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:51:51.600463 [debug] [Thread-1  ]: finished collecting timing info
18:51:51.601583 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:51:51.604830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0386877-1ce7-4da0-a5db-4bf6dba40207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b02e2eb0>]}
18:51:51.605277 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.09s]
18:51:51.605926 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:51:51.607464 [debug] [MainThread]: Acquiring new postgres connection "master"
18:51:51.607709 [debug] [MainThread]: Using postgres connection "master"
18:51:51.607843 [debug] [MainThread]: On master: BEGIN
18:51:51.607952 [debug] [MainThread]: Opening a new connection, currently in state closed
18:51:51.619393 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:51:51.619638 [debug] [MainThread]: On master: COMMIT
18:51:51.619739 [debug] [MainThread]: Using postgres connection "master"
18:51:51.619825 [debug] [MainThread]: On master: COMMIT
18:51:51.620060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:51:51.620184 [debug] [MainThread]: On master: Close
18:51:51.622406 [info ] [MainThread]: 
18:51:51.623470 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.07s.
18:51:51.624336 [debug] [MainThread]: Connection 'master' was properly closed.
18:51:51.624496 [debug] [MainThread]: Connection 'list_master' was properly closed.
18:51:51.624580 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:51:51.630878 [info ] [MainThread]: 
18:51:51.632285 [info ] [MainThread]: [32mCompleted successfully[0m
18:51:51.635429 [info ] [MainThread]: 
18:51:51.636763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:51:51.637825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b027e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5af159af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5af155520>]}


============================== 2022-01-06 18:59:38.761124 | b6db2345-5174-4dd8-96f4-d5e9613336ce ==============================
18:59:38.761124 [info ] [MainThread]: Running with dbt=1.0.0
18:59:38.762175 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:59:38.762495 [debug] [MainThread]: Tracking: tracking
18:59:38.808337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe18cbe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe18cbefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe18cbe700>]}
18:59:38.836679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:59:38.837018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:59:38.878387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6db2345-5174-4dd8-96f4-d5e9613336ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe18cf4160>]}
18:59:38.890956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6db2345-5174-4dd8-96f4-d5e9613336ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe18c9c9d0>]}
18:59:38.892073 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:59:38.894900 [info ] [MainThread]: 
18:59:38.896076 [debug] [MainThread]: Acquiring new postgres connection "master"
18:59:38.901321 [debug] [ThreadPool]: Acquiring new postgres connection "list_master"
18:59:38.913370 [debug] [ThreadPool]: Using postgres connection "list_master"
18:59:38.913669 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master"} */

    select distinct nspname from pg_namespace
  
18:59:38.913803 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:59:38.964717 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
18:59:38.968784 [debug] [ThreadPool]: On list_master: Close
18:59:38.971702 [debug] [ThreadPool]: Acquiring new postgres connection "list_master_public"
18:59:38.978094 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:59:38.979866 [debug] [ThreadPool]: On list_master_public: BEGIN
18:59:38.980316 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:59:39.005100 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:59:39.005449 [debug] [ThreadPool]: Using postgres connection "list_master_public"
18:59:39.005604 [debug] [ThreadPool]: On list_master_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "list_master_public"} */
select
      'master' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'master' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:59:39.008100 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:59:39.009423 [debug] [ThreadPool]: On list_master_public: ROLLBACK
18:59:39.009799 [debug] [ThreadPool]: On list_master_public: Close
18:59:39.018526 [debug] [MainThread]: Using postgres connection "master"
18:59:39.019798 [debug] [MainThread]: On master: BEGIN
18:59:39.020375 [debug] [MainThread]: Opening a new connection, currently in state init
18:59:39.040305 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:59:39.040861 [debug] [MainThread]: Using postgres connection "master"
18:59:39.041078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:59:39.045656 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
18:59:39.048430 [debug] [MainThread]: On master: ROLLBACK
18:59:39.053287 [debug] [MainThread]: Using postgres connection "master"
18:59:39.053744 [debug] [MainThread]: On master: BEGIN
18:59:39.066271 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:59:39.066975 [debug] [MainThread]: On master: COMMIT
18:59:39.067116 [debug] [MainThread]: Using postgres connection "master"
18:59:39.067214 [debug] [MainThread]: On master: COMMIT
18:59:39.080295 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
18:59:39.080601 [debug] [MainThread]: On master: Close
18:59:39.081174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:59:39.081549 [info ] [MainThread]: 
18:59:39.156749 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_first_dbt_model
18:59:39.157215 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model.............................. [RUN]
18:59:39.166584 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.167356 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_first_dbt_model
18:59:39.167609 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_first_dbt_model
18:59:39.170612 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_first_dbt_model"
18:59:39.180049 [debug] [Thread-1  ]: finished collecting timing info
18:59:39.180333 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_first_dbt_model
18:59:39.209658 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_first_dbt_model"
18:59:39.210289 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.210437 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: BEGIN
18:59:39.211079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:39.220514 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:59:39.221997 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.222659 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */


  create  table "master"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:59:39.225493 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:59:39.232193 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.232951 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:59:39.234034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:59:39.239500 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.239868 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
alter table "master"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:59:39.240350 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:59:39.251088 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:59:39.252099 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.252434 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: COMMIT
18:59:39.309955 [debug] [Thread-1  ]: SQL status: COMMIT in 0.06 seconds
18:59:39.319133 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_first_dbt_model"
18:59:39.327125 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_first_dbt_model"} */
drop table if exists "master"."public"."my_first_dbt_model__dbt_backup" cascade
18:59:39.331002 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:59:39.332193 [debug] [Thread-1  ]: finished collecting timing info
18:59:39.332429 [debug] [Thread-1  ]: On model.Fire_incidents.my_first_dbt_model: Close
18:59:39.332924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6db2345-5174-4dd8-96f4-d5e9613336ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1837f6d0>]}
18:59:39.333210 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model......................... [[32mSELECT 2[0m in 0.17s]
18:59:39.333898 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_first_dbt_model
18:59:39.348806 [debug] [Thread-1  ]: Began running node model.Fire_incidents.my_second_dbt_model
18:59:39.349156 [info ] [Thread-1  ]: 2 of 2 START view model public.my_second_dbt_model.............................. [RUN]
18:59:39.351005 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Fire_incidents.my_second_dbt_model"
18:59:39.351320 [debug] [Thread-1  ]: Began compiling node model.Fire_incidents.my_second_dbt_model
18:59:39.351482 [debug] [Thread-1  ]: Compiling model.Fire_incidents.my_second_dbt_model
18:59:39.354079 [debug] [Thread-1  ]: Writing injected SQL for node "model.Fire_incidents.my_second_dbt_model"
18:59:39.354942 [debug] [Thread-1  ]: finished collecting timing info
18:59:39.370177 [debug] [Thread-1  ]: Began executing node model.Fire_incidents.my_second_dbt_model
18:59:39.415596 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Fire_incidents.my_second_dbt_model"
18:59:39.416159 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:59:39.416505 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: BEGIN
18:59:39.416850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:39.432310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:59:39.437667 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:59:39.437903 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */

  create view "master"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "master"."public"."my_first_dbt_model"
where id = 1
  );
18:59:39.439487 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:59:39.442418 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:59:39.442794 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
alter table "master"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:59:39.443455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:59:39.444691 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:59:39.444962 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:59:39.445131 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: COMMIT
18:59:39.448373 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:59:39.450444 [debug] [Thread-1  ]: Using postgres connection "model.Fire_incidents.my_second_dbt_model"
18:59:39.450855 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "postgress", "target_name": "dev", "node_id": "model.Fire_incidents.my_second_dbt_model"} */
drop view if exists "master"."public"."my_second_dbt_model__dbt_backup" cascade
18:59:39.451636 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:59:39.453733 [debug] [Thread-1  ]: finished collecting timing info
18:59:39.454137 [debug] [Thread-1  ]: On model.Fire_incidents.my_second_dbt_model: Close
18:59:39.457097 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6db2345-5174-4dd8-96f4-d5e9613336ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1a547970>]}
18:59:39.457622 [info ] [Thread-1  ]: 2 of 2 OK created view model public.my_second_dbt_model......................... [[32mCREATE VIEW[0m in 0.11s]
18:59:39.458047 [debug] [Thread-1  ]: Finished running node model.Fire_incidents.my_second_dbt_model
18:59:39.460488 [debug] [MainThread]: Acquiring new postgres connection "master"
18:59:39.460755 [debug] [MainThread]: Using postgres connection "master"
18:59:39.460889 [debug] [MainThread]: On master: BEGIN
18:59:39.460999 [debug] [MainThread]: Opening a new connection, currently in state closed
18:59:39.485953 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:59:39.487101 [debug] [MainThread]: On master: COMMIT
18:59:39.487922 [debug] [MainThread]: Using postgres connection "master"
18:59:39.488242 [debug] [MainThread]: On master: COMMIT
18:59:39.488667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:59:39.488960 [debug] [MainThread]: On master: Close
18:59:39.499211 [info ] [MainThread]: 
18:59:39.499870 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.60s.
18:59:39.502566 [debug] [MainThread]: Connection 'master' was properly closed.
18:59:39.503037 [debug] [MainThread]: Connection 'list_master' was properly closed.
18:59:39.509763 [debug] [MainThread]: Connection 'model.Fire_incidents.my_second_dbt_model' was properly closed.
18:59:39.521957 [info ] [MainThread]: 
18:59:39.522897 [info ] [MainThread]: [32mCompleted successfully[0m
18:59:39.524602 [info ] [MainThread]: 
18:59:39.531902 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
18:59:39.533865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1a547160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1a5479a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1837b040>]}
